---
title: Tutoriais de Âncoras Espaciais do Azure – 2. Salvar, recuperar e compartilhar Âncoras Espaciais do Azure
description: Conclua este curso para saber como implementar o reconhecimento facial do Azure em um aplicativo de realidade misturada.
author: jessemcculloch
ms.author: jemccull
ms.date: 02/26/2019
ms.topic: article
keywords: realidade misturada, unity, tutorial, hololens
ms.localizationpriority: high
ms.openlocfilehash: 36f25229469e848a3f0612a5971cc8e9381262f5
ms.sourcegitcommit: 536fd45b48a70bbeca1454cef517ae007225e533
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/27/2020
ms.locfileid: "80362004"
---
# <a name="2-saving-retrieving-and-sharing-azure-spatial-anchors"></a><span data-ttu-id="d5784-105">2. Salvar, recuperar e compartilhar Âncoras Espaciais do Azure</span><span class="sxs-lookup"><span data-stu-id="d5784-105">2. Saving, retrieving, and sharing Azure Spatial Anchors</span></span>

<span data-ttu-id="d5784-106">Neste tutorial, você aprenderá a salvar Âncoras Espaciais do Azure em várias sessões de aplicativo salvando a ID de âncora no armazenamento do HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="d5784-106">In this tutorial, you will learn how to save Azure Spatial Anchors across multiple app sessions by saving the anchor ID to the HoloLens 2's storage.</span></span> <span data-ttu-id="d5784-107">Você também aprenderá a compartilhar essa ID de âncora para outros dispositivos para um alinhamento de âncora de vários dispositivos.</span><span class="sxs-lookup"><span data-stu-id="d5784-107">You will also learn how to share this anchor ID to other devices for a multi-device anchor alignment.</span></span>

## <a name="objectives"></a><span data-ttu-id="d5784-108">Objetivos</span><span class="sxs-lookup"><span data-stu-id="d5784-108">Objectives</span></span>

* <span data-ttu-id="d5784-109">Saiba como salvar e recuperar IDs de Âncora Espacial do Azure de e para o disco local do HoloLens 2 para persistência entre sessões de aplicativo</span><span class="sxs-lookup"><span data-stu-id="d5784-109">Learn how to save and retrieve Azure Spatial Anchor IDs to and from the HoloLens 2 local disk, for persistence between app sessions</span></span>
* <span data-ttu-id="d5784-110">Saiba como compartilhar IDs de Âncora Espacial do Azure entre usuários em um cenário de vários dispositivos</span><span class="sxs-lookup"><span data-stu-id="d5784-110">Learn how to share Azure Spatial Anchor IDs between users in a multi-device scenario</span></span>

## <a name="preparing-the-scene"></a><span data-ttu-id="d5784-111">Preparando a cena</span><span class="sxs-lookup"><span data-stu-id="d5784-111">Preparing the scene</span></span>

<span data-ttu-id="d5784-112">Na janela Projeto, navegue até a pasta **Ativos** > **MRTK.Tutoriais.AzureSpatialAnchors** > **Pré-Fabricados**.</span><span class="sxs-lookup"><span data-stu-id="d5784-112">In the Project window, navigate to **Assets** > **MRTK.Tutorials.AzureSpatialAnchors** > **Prefabs** folder.</span></span> <span data-ttu-id="d5784-113">Ao manter pressionado o botão CTRL, clique em **ButtonParent_SaveAnchorId** e **ButtonParent_ShareAnchorId** para selecionar os dois pré-fabricados, então arraste-os para a janela Hierarquia para adicioná-los à cena:</span><span class="sxs-lookup"><span data-stu-id="d5784-113">While holding down the CTRL button, click on **ButtonParent_SaveAnchorId** and **ButtonParent_ShareAnchorId** to select the two prefabs, then drag them into the Hierarchy window to add them to the scene:</span></span>

![mrlearning-asa](images/mrlearning-asa/tutorial2-section1-step1-1.png)

## <a name="persist-azure-anchors-between-app-sessions---save-anchor-id-to-disk"></a><span data-ttu-id="d5784-115">Persistir âncoras do Azure entre sessões de aplicativo – salvar ID de âncora em disco</span><span class="sxs-lookup"><span data-stu-id="d5784-115">Persist Azure Anchors between app sessions - Save anchor ID to disk</span></span>
<!-- TODO: Consider renaming to 'Persist Azure Anchors between app sessions' -->

<span data-ttu-id="d5784-116">Nesta seção, você aprenderá a salvar e recuperar a ID de âncora do Azure de e para o disco local do HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="d5784-116">In this section, you will learn how to save and retrieve the Azure Anchor ID to and from the HoloLens 2 local disk.</span></span> <span data-ttu-id="d5784-117">Isso permitirá que você consulte o Azure para a mesma ID de âncora entre diferentes sessões de aplicativo, permitindo que os hologramas ancorados sejam posicionados na mesma localização que na sessão do aplicativo anterior.</span><span class="sxs-lookup"><span data-stu-id="d5784-117">This will allow you to query Azure for the same anchor ID between different app sessions, allowing the anchored holograms to be position at the same location as in the previous app session.</span></span>

<span data-ttu-id="d5784-118">Na janela Hierarquia, expanda o objeto **ButtonParent_SaveAnchorId objeto** que contém dois botões, um botão para salvar a ID de Âncora do Azure no armazenamento do HoloLens 2 e outro para recuperar a ID salva do disco:</span><span class="sxs-lookup"><span data-stu-id="d5784-118">In the Hierarchy window, expand the **ButtonParent_SaveAnchorId** object which contains two buttons, one button for saving the Azure Anchor ID to the HoloLens 2 storage and another for retrieving the saved ID from the disk:</span></span>

![mrlearning-asa](images/mrlearning-asa/tutorial2-section2-step1-1.png)

<span data-ttu-id="d5784-120">Siga as mesmas etapas apresentadas nas instruções para [configurar os botões para operar a cena](mrlearning-asa-ch1.md#configuring-the-buttons-to-operate-the-scene) do tutorial anterior para configurar o componente **Botão pressionável do HoloLens 2 (Script)** e o componente **Interagir (Script)** em cada um dos dois botões:</span><span class="sxs-lookup"><span data-stu-id="d5784-120">Follow the same steps as in the [configuring the buttons to operate the scene](mrlearning-asa-ch1.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Pressable Button Holo Lens 2 (Script)** component and the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="d5784-121">Para o objeto **SaveAzureAnchorIdToDisk**, atribua a função AnchorModuleScript > **SaveAzureAnchorIdToDisk ()** .</span><span class="sxs-lookup"><span data-stu-id="d5784-121">For the **SaveAzureAnchorIdToDisk** object, assign the AnchorModuleScript > **SaveAzureAnchorIdToDisk ()** function.</span></span>
* <span data-ttu-id="d5784-122">Para o objeto **GetAzureAnchorIdFromDisk**, atribua a função AnchorModuleScript > **GetAzureAnchorIdFromDisk ()** .</span><span class="sxs-lookup"><span data-stu-id="d5784-122">For the **GetAzureAnchorIdFromDisk** object, assign the AnchorModuleScript > **GetAzureAnchorIdFromDisk ()** function.</span></span>

<span data-ttu-id="d5784-123">Se você criar o aplicativo atualizado para seu HoloLens, agora poderá persistir as Âncoras Espaciais do Azure entre as sessões do aplicativo, salvando a ID da Âncora do Azure.</span><span class="sxs-lookup"><span data-stu-id="d5784-123">If you build the updated application to your HoloLens, you can now persist Azure Spatial Anchors between app sessions by saving the Azure Anchor ID.</span></span> <span data-ttu-id="d5784-124">Para testá-lo, você pode seguir estas etapas:</span><span class="sxs-lookup"><span data-stu-id="d5784-124">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="d5784-125">Mover a experiência do Rocket Launcher para a localização desejada.</span><span class="sxs-lookup"><span data-stu-id="d5784-125">Move the Rocket Launcher experience to desired location.</span></span>
2. <span data-ttu-id="d5784-126">Inicie a Sessão do Azure.</span><span class="sxs-lookup"><span data-stu-id="d5784-126">Start Azure Session.</span></span>
3. <span data-ttu-id="d5784-127">Criar a Âncora do Azure (cria âncoras na localização da experiência do Rocket Launcher).</span><span class="sxs-lookup"><span data-stu-id="d5784-127">Create Azure Anchor (creates anchors at the location of the Rocket Launcher experience).</span></span>
4. <span data-ttu-id="d5784-128">Salve a ID de Âncora do Azure no disco.</span><span class="sxs-lookup"><span data-stu-id="d5784-128">Save Azure Anchor ID to Disk.</span></span>
5. <span data-ttu-id="d5784-129">Reinicie o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d5784-129">Restart the application.</span></span>
6. <span data-ttu-id="d5784-130">Obter a Âncora do Azure do Disco (carrega a ID de âncora que você acabou de salvar).</span><span class="sxs-lookup"><span data-stu-id="d5784-130">Get Azure Anchor from Disk (loads the anchor ID you just saved).</span></span>
7. <span data-ttu-id="d5784-131">Inicie a Sessão do Azure.</span><span class="sxs-lookup"><span data-stu-id="d5784-131">Start Azure Session.</span></span>
8. <span data-ttu-id="d5784-132">Localize a Âncora do Azure (posiciona a experiência do Rocket Launcher na localização da etapa 3).</span><span class="sxs-lookup"><span data-stu-id="d5784-132">Find Azure Anchor (positions the Rocket Launcher experience at the location from step 3).</span></span>

> [!NOTE]
> <span data-ttu-id="d5784-133">Para reiniciar completamente o aplicativo, depois de sair do modo de exibição do aplicativo imersivo, a janela do aplicativo na página inicial de realidade misturada precisará ser fechada antes de reiniciar o aplicativo no menu Iniciar.</span><span class="sxs-lookup"><span data-stu-id="d5784-133">To fully restart the application, after exiting the immersive app view, the app window in the mixed reality home needs to be closed before relaunching the application from the Start menu.</span></span> <span data-ttu-id="d5784-134">Para obter detalhes adicionais, você pode consultar a documentação [Como usar aplicativos no HoloLens](https://docs.microsoft.com/hololens/holographic-home#using-apps-on-hololens).</span><span class="sxs-lookup"><span data-stu-id="d5784-134">For additional details, you can refer to the [Using apps on HoloLens](https://docs.microsoft.com/hololens/holographic-home#using-apps-on-hololens) documentation.</span></span>

## <a name="share-azure-anchors-between-multiple-devices"></a><span data-ttu-id="d5784-135">Compartilhar Âncoras do Azure entre vários dispositivos</span><span class="sxs-lookup"><span data-stu-id="d5784-135">Share Azure Anchors between multiple devices</span></span>

<span data-ttu-id="d5784-136">Nesta seção, você aprenderá a compartilhar a ID de Âncora do Azure entre vários dispositivos.</span><span class="sxs-lookup"><span data-stu-id="d5784-136">In this section, you will learn how to share the Azure Anchor ID between multiple devices.</span></span> <span data-ttu-id="d5784-137">Isso permitirá que vários dispositivos consultem o Azure para a mesma ID de âncora, permitindo o alinhamento espacial dos hologramas ancorados.</span><span class="sxs-lookup"><span data-stu-id="d5784-137">This will allow multiple devices to query Azure for the same anchor ID, allowing the anchored holograms to be spatially aligned.</span></span> <span data-ttu-id="d5784-138">O alinhamento espacial, ou seja, ver os mesmos hologramas na mesma localização física entre vários dispositivos, é o segredo para experiências compartilhadas locais no HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="d5784-138">Spatial alignment, i.e. seeing the same holograms in the same physical location between multiple devices, is key to local shared experiences in the HoloLens 2.</span></span>

<span data-ttu-id="d5784-139">Há várias maneiras de transferir IDs de Âncora do Azure entre dispositivos, incluindo métodos descritos na série de [tutoriais de funcionalidades de vários usuários](mrlearning-sharing(photon)-ch1.md).</span><span class="sxs-lookup"><span data-stu-id="d5784-139">There are many ways to transfer Azure Anchor IDs between devices, including methods outlined in the the [Multi-user capabilities tutorials](mrlearning-sharing(photon)-ch1.md) series.</span></span> <span data-ttu-id="d5784-140">Neste exemplo, você usará um serviço Web simples para carregar e baixar IDs de âncora entre dispositivos.</span><span class="sxs-lookup"><span data-stu-id="d5784-140">In this example, you will use a simple web service to upload and download anchor IDs between devices.</span></span>

<span data-ttu-id="d5784-141">Na janela Hierarquia, expanda o objeto **ButtonParent_ShareAnchorId**, que contém dois botões: um botão para carregar a ID de âncora do Azure para o servidor Web e outro para baixar a ID do servidor Web:</span><span class="sxs-lookup"><span data-stu-id="d5784-141">In the Hierarchy window, expand the **ButtonParent_ShareAnchorId** object which contains two buttons; one button for uploading the Azure Anchor ID to the web server, and another for downloading the ID from the web server:</span></span>

![mrlearning-asa](images/mrlearning-asa/tutorial2-section3-step1-1.png)

<span data-ttu-id="d5784-143">Siga as mesmas etapas apresentadas nas instruções para [configurar os botões para operar a cena](mrlearning-asa-ch1.md#configuring-the-buttons-to-operate-the-scene) do tutorial anterior para configurar o componente **Botão pressionável do HoloLens 2 (Script)** e o componente **Interagir (Script)** em cada um dos dois botões:</span><span class="sxs-lookup"><span data-stu-id="d5784-143">Follow the same steps as in the [configuring the buttons to operate the scene](mrlearning-asa-ch1.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Pressable Button Holo Lens 2 (Script)** component and the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="d5784-144">Para o objeto **ShareAzureAnchorIdToNetwork**, atribua a função AnchorModuleScript > **ShareAzureAnchorIdToNetwork ()** .</span><span class="sxs-lookup"><span data-stu-id="d5784-144">For the **ShareAzureAnchorIdToNetwork** object, assign the AnchorModuleScript > **ShareAzureAnchorIdToNetwork ()** function.</span></span>
* <span data-ttu-id="d5784-145">Para o objeto **GetAzureAnchorIdFromNetwork**, atribua a função AnchorModuleScript > **GetAzureAnchorIdFromNetwork ()** .</span><span class="sxs-lookup"><span data-stu-id="d5784-145">For the **GetAzureAnchorIdFromNetwork** object, assign the AnchorModuleScript > **GetAzureAnchorIdFromNetwork ()** function.</span></span>

<span data-ttu-id="d5784-146">Se você criar o aplicativo atualizado para dois dispositivos HoloLens, agora poderá obter o alinhamento espacial entre eles compartilhando a ID de Âncora do Azure.</span><span class="sxs-lookup"><span data-stu-id="d5784-146">If you build the updated application to two HoloLens devices, you can now achieve spatial alignment between them by sharing the Azure Anchor ID.</span></span> <span data-ttu-id="d5784-147">Para testá-lo, você pode seguir estas etapas:</span><span class="sxs-lookup"><span data-stu-id="d5784-147">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="d5784-148">No dispositivo HoloLens 1: Mover a experiência do Rocket Launcher para a localização desejada.</span><span class="sxs-lookup"><span data-stu-id="d5784-148">On HoloLens device 1: Move the Rocket Launcher experience to desired location.</span></span>
2. <span data-ttu-id="d5784-149">No dispositivo HoloLens 1: Inicie a Sessão do Azure.</span><span class="sxs-lookup"><span data-stu-id="d5784-149">On HoloLens device 1: Start Azure Session.</span></span>
3. <span data-ttu-id="d5784-150">No dispositivo HoloLens 1: Criar a Âncora do Azure (cria âncoras na localização da experiência do Rocket Launcher).</span><span class="sxs-lookup"><span data-stu-id="d5784-150">On HoloLens device 1: Create Azure Anchor (creates anchors at the location of the Rocket Launcher experience).</span></span>
4. <span data-ttu-id="d5784-151">No dispositivo HoloLens 1: Compartilhar a ID de Âncora do Azure para a rede.</span><span class="sxs-lookup"><span data-stu-id="d5784-151">On HoloLens device 1: Share Azure Anchor ID to Network.</span></span>
5. <span data-ttu-id="d5784-152">No dispositivo HoloLens 2: Inicie o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="d5784-152">On HoloLens device 2: Start the application.</span></span>
6. <span data-ttu-id="d5784-153">No dispositivo HoloLens 2: Obtenha a ID de Âncora compartilhada da Rede (busca a ID de âncora que acaba de ser compartilhada do dispositivo HoloLens 1).</span><span class="sxs-lookup"><span data-stu-id="d5784-153">On HoloLens device 2: Get Shared Anchor ID from Network (fetches the anchor ID just shared from HoloLens device 1).</span></span>
7. <span data-ttu-id="d5784-154">No dispositivo HoloLens 2: Inicie a Sessão do Azure.</span><span class="sxs-lookup"><span data-stu-id="d5784-154">On HoloLens device 2: Start Azure Session.</span></span>
8. <span data-ttu-id="d5784-155">No dispositivo HoloLens 2: Localize a Âncora do Azure (posiciona a experiência do Rocket Launcher na localização da etapa 3).</span><span class="sxs-lookup"><span data-stu-id="d5784-155">On HoloLens device 2: Find Azure Anchor (positions the Rocket Launcher experience at the location from step 3).</span></span>

> [!TIP]
> <span data-ttu-id="d5784-156">Se você tiver apenas um HoloLens, ainda poderá testar a funcionalidade reiniciando o aplicativo, em vez de usar um segundo dispositivo HoloLens.</span><span class="sxs-lookup"><span data-stu-id="d5784-156">If you only have one HoloLens, you can still test the functionality by restarting the application instead of using a second HoloLens device.</span></span>

## <a name="congratulations"></a><span data-ttu-id="d5784-157">Parabéns</span><span class="sxs-lookup"><span data-stu-id="d5784-157">Congratulations</span></span>

<span data-ttu-id="d5784-158">Neste tutorial, você aprendeu a manter as Âncoras Espaciais do Azure entre as sessões do aplicativo e reinicializações do aplicativo salvando a ID de Âncora Espacial do Azure no disco local no HoloLens.</span><span class="sxs-lookup"><span data-stu-id="d5784-158">In this tutorial you learned how to persist Azure Spatial Anchors between application sessions and application restarts by saving the Azure Spatial Anchor ID to the local disk on HoloLens.</span></span> <span data-ttu-id="d5784-159">Você também aprendeu a compartilhar as Âncoras Espaciais do Azure entre vários dispositivos para uma experiência compartilhada básica com vários usuários e com holograma estático.</span><span class="sxs-lookup"><span data-stu-id="d5784-159">You also learned how to share Azure Spatial Anchors between multiple devices for a basic multi-user, static hologram shared experience.</span></span>

<span data-ttu-id="d5784-160">No próximo tutorial, você aprenderá a fornecer aos usuários comentários em tempo real.</span><span class="sxs-lookup"><span data-stu-id="d5784-160">In the next tutorial you will learn how to provide users with real-time feedback.</span></span> <span data-ttu-id="d5784-161">Esses comentários incluirão informações sobre a criação de âncora, a qualidade da compreensão do ambiente e o estado da sessão do Azure.</span><span class="sxs-lookup"><span data-stu-id="d5784-161">This feedback will include information about Anchor creation, the quality of environment understanding, and the state of the Azure session.</span></span> <span data-ttu-id="d5784-162">Sem comentários, os usuários podem não saber se uma âncora foi carregada com êxito no Azure, se a qualidade do ambiente é suficiente para a criação de âncora ou o estado atual.</span><span class="sxs-lookup"><span data-stu-id="d5784-162">Without feedback, users may not know whether an anchor has successfully been uploaded to Azure, whether the quality of the environment is sufficient for anchor creation, or the current state.</span></span>

[<span data-ttu-id="d5784-163">Próxima lição: 3. Exibir comentários da Âncora Espacial do Azure</span><span class="sxs-lookup"><span data-stu-id="d5784-163">Next Lesson: 3. Displaying Azure Spatial Anchor feedback</span></span>](mrlearning-asa-ch3.md)
