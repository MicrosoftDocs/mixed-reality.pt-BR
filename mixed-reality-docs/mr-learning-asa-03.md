---
title: Tutoriais de Âncoras Espaciais do Azure – 3. Salvar, recuperar e compartilhar Âncoras Espaciais do Azure
description: Conclua este curso para saber como implementar as Âncoras Espaciais do Azure em um aplicativo de realidade misturada.
author: jessemcculloch
ms.author: jemccull
ms.date: 07/01/2020
ms.topic: article
keywords: realidade misturada, unity, tutorial, hololens
ms.localizationpriority: high
ms.openlocfilehash: 274722588f156cb01fdd45525912e2e15687bc2d
ms.sourcegitcommit: 2f5f95a9ca1b02d94eb9163f0f4ff6b1e4126de2
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/29/2020
ms.locfileid: "87376528"
---
# <a name="3-saving-retrieving-and-sharing-azure-spatial-anchors"></a><span data-ttu-id="3f5cd-105">3. Salvar, recuperar e compartilhar Âncoras Espaciais do Azure</span><span class="sxs-lookup"><span data-stu-id="3f5cd-105">3. Saving, retrieving, and sharing Azure Spatial Anchors</span></span>

<span data-ttu-id="3f5cd-106">Neste tutorial, você aprenderá a salvar Âncoras Espaciais do Azure em várias sessões de aplicativo salvando a ID de âncora no armazenamento do HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-106">In this tutorial, you will learn how to save Azure Spatial Anchors across multiple app sessions by saving the anchor ID to the HoloLens 2's storage.</span></span> <span data-ttu-id="3f5cd-107">Você também aprenderá a compartilhar essa ID de âncora para outros dispositivos para um alinhamento de âncora de vários dispositivos.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-107">You will also learn how to share this anchor ID to other devices for a multi-device anchor alignment.</span></span>

## <a name="objectives"></a><span data-ttu-id="3f5cd-108">Objetivos</span><span class="sxs-lookup"><span data-stu-id="3f5cd-108">Objectives</span></span>

* <span data-ttu-id="3f5cd-109">Saber como obter o alinhamento espacial entre várias sessões de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-109">Learn how to achieve spatial alignment across multiple app sessions.</span></span>
* <span data-ttu-id="3f5cd-110">Saber como obter um alinhamento espacial entre vários dispositivos.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-110">Learn how to achieve spatial alignment between multiple devices.</span></span>

## <a name="preparing-the-scene"></a><span data-ttu-id="3f5cd-111">Preparando a cena</span><span class="sxs-lookup"><span data-stu-id="3f5cd-111">Preparing the scene</span></span>

<span data-ttu-id="3f5cd-112">Na janela Hierarquia, expanda o objeto **ButtonParent**.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-112">In the Hierarchy window, expand the **ButtonParent** object.</span></span> <span data-ttu-id="3f5cd-113">Selecione o **últimos quatro objetos de botão filho**.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-113">Select the **last four child button** objects.</span></span> <span data-ttu-id="3f5cd-114">Na janela Inspetor, **marque** caixa de seleção ao lado do campo de nome para ativar todos os objetos.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-114">In the Inspector window, **check** the checkbox next to the name field to make all the objects active.</span></span>

![mr-learning-asa](images/mr-learning-asa/asa-03-section1-step1-1.png)

<span data-ttu-id="3f5cd-116">Na janela Hierarquia, selecione o objeto **ButtonParent**.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-116">In the Hierarchy window, select the **ButtonParent** objects.</span></span> <span data-ttu-id="3f5cd-117">Em seguida, na janela Inspetor, localize o componente **GridObjectCollection** e clique no botão **Atualizar Coleção** para atualizar a posição de todos os objetos filho do objeto **ButtonParent**.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-117">Then in the Inspector window, locate the **GridObjectCollection** component and click the **Update Collection** button to update the position of all the **ButtonParent** object's child objects.</span></span>

![mr-learning-asa](images/mr-learning-asa/asa-03-section1-step1-2.png)

## <a name="persisting-azure-spatial-anchors-between-app-sessions"></a><span data-ttu-id="3f5cd-119">Persistir Âncoras Espaciais do Azure entre sessões do aplicativo</span><span class="sxs-lookup"><span data-stu-id="3f5cd-119">Persisting Azure Spatial Anchors between app sessions</span></span>

<span data-ttu-id="3f5cd-120">Nesta seção, você aprenderá a salvar e recuperar a ID de Âncora do Azure de e para o disco local do HoloLens.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-120">In this section, you will learn how to save and retrieve the Azure Anchor ID to and from the HoloLens' local disk.</span></span> <span data-ttu-id="3f5cd-121">Isso permitirá que você consulte a mesma ID de âncora no Azure entre diferentes sessões do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-121">This will allow you to query Azure for the same anchor ID between different app sessions.</span></span> <span data-ttu-id="3f5cd-122">Assim os hologramas ancorados serão posicionados no mesmo local que na sessão anterior do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-122">It will enable the anchored holograms to be positioned at the same location as in the previous app session.</span></span>

<span data-ttu-id="3f5cd-123">Na janela Hierarquia, expanda o objeto **ButtonParent** e localize os dois botões chamados **SaveAzureAnchorIdToDisk** e **GetAzureAnchorIdFromDisk**:</span><span class="sxs-lookup"><span data-stu-id="3f5cd-123">In the Hierarchy window, expand the **ButtonParent** object and locate the two buttons named **SaveAzureAnchorIdToDisk** and **GetAzureAnchorIdFromDisk**:</span></span>

![mr-learning-asa](images/mr-learning-asa/asa-03-section2-step1-1.png)

<span data-ttu-id="3f5cd-125">Siga as mesmas etapas apresentadas nas instruções para [configurar os botões para operar a cena](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) do tutorial anterior para configurar o componente **Interagir (Script)** em cada um dos dois botões:</span><span class="sxs-lookup"><span data-stu-id="3f5cd-125">Follow the same steps as in the [configuring the buttons to operate the scene](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="3f5cd-126">Para o objeto de botão **SaveAzureAnchorIdToDisk**, atribua a função AnchorModuleScript > **SaveAzureAnchorIdToDisk ()** .</span><span class="sxs-lookup"><span data-stu-id="3f5cd-126">For the **SaveAzureAnchorIdToDisk** button object, assign the AnchorModuleScript > **SaveAzureAnchorIdToDisk ()** function.</span></span>
* <span data-ttu-id="3f5cd-127">Para o objeto de botão **GetAzureAnchorIdFromDisk**, atribua a função AnchorModuleScript > **GetAzureAnchorIdFromDisk ()** .</span><span class="sxs-lookup"><span data-stu-id="3f5cd-127">For the **GetAzureAnchorIdFromDisk** button object, assign the AnchorModuleScript > **GetAzureAnchorIdFromDisk ()** function.</span></span>

<span data-ttu-id="3f5cd-128">Se você compilar o aplicativo atualizado para o HoloLens, agora poderá persistir as Âncoras Espaciais do Azure entre as sessões do aplicativo, salvando a ID da Âncora do Azure.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-128">If you build the updated app to your HoloLens, you can now persist Azure Spatial Anchors between app sessions by saving the Azure Anchor ID.</span></span> <span data-ttu-id="3f5cd-129">Para testá-lo, você pode seguir estas etapas:</span><span class="sxs-lookup"><span data-stu-id="3f5cd-129">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="3f5cd-130">Mova o Rover Explorer para o local desejado</span><span class="sxs-lookup"><span data-stu-id="3f5cd-130">Move the Rover Explorer to the desired location</span></span>
2. <span data-ttu-id="3f5cd-131">Inicie a Sessão do Azure</span><span class="sxs-lookup"><span data-stu-id="3f5cd-131">Start Azure Session</span></span>
3. <span data-ttu-id="3f5cd-132">Crie a Âncora do Azure (cria âncoras na localização do Rover Explorer)</span><span class="sxs-lookup"><span data-stu-id="3f5cd-132">Create Azure Anchor (creates anchors at the location of the Rover Explorer)</span></span>
4. <span data-ttu-id="3f5cd-133">Salve a ID de Âncora do Azure no disco</span><span class="sxs-lookup"><span data-stu-id="3f5cd-133">Save Azure Anchor ID to Disk</span></span>
5. <span data-ttu-id="3f5cd-134">Reinicie o aplicativo</span><span class="sxs-lookup"><span data-stu-id="3f5cd-134">Restart the app</span></span>
6. <span data-ttu-id="3f5cd-135">Obtenha a Âncora do Azure do Disco (carrega a ID de âncora que você acabou de salvar)</span><span class="sxs-lookup"><span data-stu-id="3f5cd-135">Get Azure Anchor from Disk (loads the anchor ID you just saved)</span></span>
7. <span data-ttu-id="3f5cd-136">Inicie a Sessão do Azure</span><span class="sxs-lookup"><span data-stu-id="3f5cd-136">Start Azure Session</span></span>
8. <span data-ttu-id="3f5cd-137">Localize a Âncora do Azure (posiciona o Rover Explorer na localização da etapa 3)</span><span class="sxs-lookup"><span data-stu-id="3f5cd-137">Find Azure Anchor (positions the Rover Explorer at the location from step 3)</span></span>

> [!NOTE]
> <span data-ttu-id="3f5cd-138">Para reiniciar completamente o aplicativo, depois de sair do modo de exibição imersivo do aplicativo, a janela do aplicativo na página inicial de realidade misturada precisará ser fechada antes de reiniciar o aplicativo no menu Iniciar.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-138">To fully restart the app, after exiting the immersive app view, the app window in the mixed reality home needs to be closed before relaunching it from the Start menu.</span></span> <span data-ttu-id="3f5cd-139">Para obter detalhes adicionais, você pode consultar a documentação [Como usar aplicativos no HoloLens](https://docs.microsoft.com/hololens/holographic-home#using-apps-on-hololens).</span><span class="sxs-lookup"><span data-stu-id="3f5cd-139">For additional details, you can refer to the [Using apps on HoloLens](https://docs.microsoft.com/hololens/holographic-home#using-apps-on-hololens) documentation.</span></span>

## <a name="sharing-azure-spatial-anchors-between-devices"></a><span data-ttu-id="3f5cd-140">Compartilhar Âncoras Espaciais do Azure entre dispositivos</span><span class="sxs-lookup"><span data-stu-id="3f5cd-140">Sharing Azure Spatial Anchors between devices</span></span>

<span data-ttu-id="3f5cd-141">Nesta seção, você aprenderá a compartilhar a ID de Âncora do Azure entre vários dispositivos.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-141">In this section, you will learn how to share the Azure Anchor ID between multiple devices.</span></span> <span data-ttu-id="3f5cd-142">Isso permitirá que vários dispositivos consultem o Azure para a mesma ID de âncora, permitindo o alinhamento espacial dos hologramas ancorados.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-142">This will allow multiple devices to query Azure for the same anchor ID, allowing the anchored holograms to be spatially aligned.</span></span> <span data-ttu-id="3f5cd-143">O alinhamento espacial, ou seja, ver os mesmos hologramas na mesma localização física entre vários dispositivos, é o segredo para experiências compartilhadas locais no HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-143">Spatial alignment, i.e., seeing the same holograms in the same physical location between multiple devices, is key to local shared experiences in the HoloLens 2.</span></span>

<span data-ttu-id="3f5cd-144">Há várias maneiras de transferir IDs de Âncora do Azure entre dispositivos, incluindo métodos descritos na série de [Tutoriais de funcionalidades de vários usuários](mr-learning-sharing-02.md).</span><span class="sxs-lookup"><span data-stu-id="3f5cd-144">There are many ways to transfer Azure Anchor IDs between devices, including methods outlined in the [Multi-user capabilities tutorials](mr-learning-sharing-02.md) series.</span></span> <span data-ttu-id="3f5cd-145">Neste exemplo, você usará um serviço Web simples para carregar e baixar IDs de âncora entre dispositivos.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-145">In this example, you will use a simple web service to upload and download anchor IDs between devices.</span></span>

<span data-ttu-id="3f5cd-146">Na janela Hierarquia, expanda o objeto **ButtonParent**.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-146">In the Hierarchy window, expand the **ButtonParent** object.</span></span>   <span data-ttu-id="3f5cd-147">Localize os dois botões chamados **ShareAzureAnchorIdToNetwork** e **GetAzureAnchorIdFromNetwork**:</span><span class="sxs-lookup"><span data-stu-id="3f5cd-147">Locate the two buttons named **ShareAzureAnchorIdToNetwork** and **GetAzureAnchorIdFromNetwork**:</span></span>

![mr-learning-asa](images/mr-learning-asa/asa-03-section3-step1-1.png)

<span data-ttu-id="3f5cd-149">Siga as mesmas etapas apresentadas nas instruções para [configurar os botões para operar a cena](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) do tutorial anterior para configurar o componente **Interagir (Script)** em cada um dos dois botões:</span><span class="sxs-lookup"><span data-stu-id="3f5cd-149">Follow the same steps as in the [configuring the buttons to operate the scene](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="3f5cd-150">Para o objeto **ShareAzureAnchorIdToNetwork**, atribua a função AnchorModuleScript > **ShareAzureAnchorIdToNetwork ()** .</span><span class="sxs-lookup"><span data-stu-id="3f5cd-150">For the **ShareAzureAnchorIdToNetwork** object, assign the AnchorModuleScript > **ShareAzureAnchorIdToNetwork ()** function.</span></span>
* <span data-ttu-id="3f5cd-151">Para o objeto **GetAzureAnchorIdFromNetwork**, atribua a função AnchorModuleScript > **GetAzureAnchorIdFromNetwork ()** .</span><span class="sxs-lookup"><span data-stu-id="3f5cd-151">For the **GetAzureAnchorIdFromNetwork** object, assign the AnchorModuleScript > **GetAzureAnchorIdFromNetwork ()** function.</span></span>

<span data-ttu-id="3f5cd-152">Se você compilar o aplicativo atualizado para dois dispositivos HoloLens, poderá obter o alinhamento espacial compartilhando a ID de Âncora do Azure.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-152">If you build the updated app to two HoloLens devices, you can now achieve spatial alignment by sharing the Azure Anchor ID.</span></span> <span data-ttu-id="3f5cd-153">Para testá-lo, você pode seguir estas etapas:</span><span class="sxs-lookup"><span data-stu-id="3f5cd-153">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="3f5cd-154">No dispositivo HoloLens 1: Mova o Rover Explorer para o local desejado.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-154">On HoloLens device 1: Move the Rover Explorer to the desired location.</span></span>
2. <span data-ttu-id="3f5cd-155">No dispositivo HoloLens 1: Inicie a Sessão do Azure.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-155">On HoloLens device 1: Start Azure Session.</span></span>
3. <span data-ttu-id="3f5cd-156">No dispositivo HoloLens 1: Crie a Âncora do Azure (cria âncoras na localização do Rover Explorer).</span><span class="sxs-lookup"><span data-stu-id="3f5cd-156">On HoloLens device 1: Create Azure Anchor (creates anchors at the location of the Rover Explorer).</span></span>
4. <span data-ttu-id="3f5cd-157">No dispositivo HoloLens 1: Compartilhar a ID de Âncora do Azure para a rede.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-157">On HoloLens device 1: Share Azure Anchor ID to Network.</span></span>
5. <span data-ttu-id="3f5cd-158">No dispositivo HoloLens 2: Inicie o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-158">On HoloLens device 2: Start the app.</span></span>
6. <span data-ttu-id="3f5cd-159">No dispositivo HoloLens 2: Obtenha a ID de Âncora compartilhada da Rede (busca a ID de âncora que acaba de ser compartilhada do dispositivo HoloLens 1).</span><span class="sxs-lookup"><span data-stu-id="3f5cd-159">On HoloLens device 2: Get Shared Anchor ID from Network (fetches the anchor ID just shared from HoloLens device 1).</span></span>
7. <span data-ttu-id="3f5cd-160">No dispositivo HoloLens 2: Inicie a Sessão do Azure.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-160">On HoloLens device 2: Start Azure Session.</span></span>
8. <span data-ttu-id="3f5cd-161">No dispositivo HoloLens 2: Localize a Âncora do Azure (posiciona o Rover Explorer na localização da etapa 3).</span><span class="sxs-lookup"><span data-stu-id="3f5cd-161">On HoloLens device 2: Find Azure Anchor (positions the Rover Explorer at the location from step 3).</span></span>

> [!TIP]
> <span data-ttu-id="3f5cd-162">Se você tiver apenas um HoloLens, ainda poderá testar a funcionalidade reiniciando o aplicativo, em vez de usar um segundo dispositivo HoloLens.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-162">If you only have one HoloLens, you can still test the functionality by restarting the app instead of using a second HoloLens device.</span></span>

## <a name="congratulations"></a><span data-ttu-id="3f5cd-163">Parabéns</span><span class="sxs-lookup"><span data-stu-id="3f5cd-163">Congratulations</span></span>

<span data-ttu-id="3f5cd-164">Neste tutorial, você aprendeu a manter as Âncoras Espaciais do Azure entre as sessões do aplicativo e reinicializações do aplicativo salvando a ID de Âncora Espacial do Azure no disco local no HoloLens.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-164">In this tutorial, you learned how to persist Azure Spatial Anchors between app sessions and app restarts by saving the Azure Spatial Anchor ID to the local disk on HoloLens.</span></span> <span data-ttu-id="3f5cd-165">Você também aprendeu a compartilhar as Âncoras Espaciais do Azure entre vários dispositivos para uma experiência compartilhada básica com vários usuários e com holograma estático.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-165">You also learned how to share Azure Spatial Anchors between multiple devices for a basic multi-user, static hologram shared experience.</span></span>

<span data-ttu-id="3f5cd-166">No próximo tutorial, você aprenderá a fornecer aos usuários comentários em tempo real.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-166">In the next tutorial, you will learn how to provide users with real-time feedback.</span></span> <span data-ttu-id="3f5cd-167">Esses comentários incluirão informações sobre a criação da âncora, a qualidade da compreensão do ambiente e o estado da sessão do Azure.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-167">This feedback will include information about Anchor creation, the quality of environment understanding, and the Azure session's state.</span></span> <span data-ttu-id="3f5cd-168">Sem comentários, os usuários podem não saber se uma âncora foi carregada com êxito no Azure, se a qualidade do ambiente é suficiente para a criação de âncora ou o estado atual.</span><span class="sxs-lookup"><span data-stu-id="3f5cd-168">Without feedback, users may not know whether an anchor has successfully been uploaded to Azure, whether the quality of the environment is sufficient for anchor creation, or the current state.</span></span>

[<span data-ttu-id="3f5cd-169">Próximo tutorial: 4. Exibir comentários da Âncora Espacial do Azure</span><span class="sxs-lookup"><span data-stu-id="3f5cd-169">Next Tutorial: 4. Displaying Azure Spatial Anchor feedback</span></span>](mr-learning-asa-04.md)
