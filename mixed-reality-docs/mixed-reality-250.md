---
title: Sr Sharing 250-o HoloLens e os headsets de imersão
description: Siga este passo a passo de codificação usando headsets de Unity, Visual Studio, HoloLens e Windows Mixed Reality para aprender os detalhes do compartilhamento de hologramas entre dispositivos de realidade misturada.
author: keveleigh
ms.author: kurtie
ms.date: 10/22/2019
ms.topic: article
keywords: holotoolkit, mixedrealitytoolkit, mixedrealitytoolkit-Unity, imersiva, controlador de movimento, compartilhamento, controlador Xbox, rede, dispositivo cruzado
ms.openlocfilehash: c8d341f75424887ca1b0994c8a4d16a0bded671e
ms.sourcegitcommit: 6bc6757b9b273a63f260f1716c944603dfa51151
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 11/01/2019
ms.locfileid: "73437868"
---
>[!NOTE]
><span data-ttu-id="6c3d2-104">Os tutoriais misturados do Academia de realidade foram projetados com o HoloLens (1º gen) e com o fone de cabeça de imersão de realidade misturada.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-104">The Mixed Reality Academy tutorials were designed with HoloLens (1st gen) and Mixed Reality Immersive Headsets in mind.</span></span>  <span data-ttu-id="6c3d2-105">Como tal, achamos que é importante deixar esses tutoriais em vigor para os desenvolvedores que ainda estão procurando orientação no desenvolvimento para esses dispositivos.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-105">As such, we feel it is important to leave these tutorials in place for developers who are still looking for guidance in developing for those devices.</span></span>  <span data-ttu-id="6c3d2-106">Esses tutoriais **_não_** serão atualizados com os conjuntos de ferramentas e as interações mais recentes usados para o HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-106">These tutorials will **_not_** be updated with the latest toolsets or interactions being used for HoloLens 2.</span></span>  <span data-ttu-id="6c3d2-107">Eles serão mantidos para continuar a trabalhar nos dispositivos com suporte.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-107">They will be maintained to continue working on the supported devices.</span></span> <span data-ttu-id="6c3d2-108">[Uma nova série de tutoriais](mrlearning-base.md) foi postada para o HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-108">[A new series of tutorials](mrlearning-base.md) has been posted for HoloLens 2.</span></span>

<br>

# <a name="mr-sharing-250-hololens-and-immersive-headsets"></a><span data-ttu-id="6c3d2-109">Sr Sharing 250: os headsets de HoloLens e de imersão</span><span class="sxs-lookup"><span data-stu-id="6c3d2-109">MR Sharing 250: HoloLens and immersive headsets</span></span>

<span data-ttu-id="6c3d2-110">Com a flexibilidade do Plataforma Universal do Windows (UWP), é fácil criar um aplicativo que abranja vários dispositivos.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-110">With the flexibility of Universal Windows Platform (UWP), it is easy to create an application that spans multiple devices.</span></span> <span data-ttu-id="6c3d2-111">Com essa flexibilidade, podemos criar experiências que aproveitam os pontos fortes de cada dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-111">With this flexibility, we can create experiences that leverage the strengths of each device.</span></span> <span data-ttu-id="6c3d2-112">Este tutorial abordará uma experiência compartilhada básica que é executada em headsets de uso de realidade mista do HoloLens e do Windows.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-112">This tutorial will cover a basic shared experience that runs on both HoloLens and Windows Mixed Reality immersive headsets.</span></span> <span data-ttu-id="6c3d2-113">Este conteúdo foi originalmente entregue na conferência do Microsoft Build 2017 em Seattle, WA.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-113">This content was originally delivered at the Microsoft Build 2017 conference in Seattle, WA.</span></span>

<span data-ttu-id="6c3d2-114">**Neste tutorial, iremos:**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-114">**In this tutorial, we will:**</span></span>

* <span data-ttu-id="6c3d2-115">Configure uma rede usando o UNET.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-115">Setup a network using UNET.</span></span>
* <span data-ttu-id="6c3d2-116">Compartilhe hologramas entre dispositivos de realidade misturada.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-116">Share holograms across mixed reality devices.</span></span>
* <span data-ttu-id="6c3d2-117">Estabeleça uma exibição diferente do aplicativo dependendo de qual dispositivo de realidade misturada está sendo usado.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-117">Establish a different view of the application depending on which mixed reality device is being used.</span></span>
* <span data-ttu-id="6c3d2-118">Crie uma experiência compartilhada em que os usuários do HoloLens guiam os usuários do headset com um quebra-cabeças simples.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-118">Create a shared experience where HoloLens users guide immersive headsets users through some simple puzzles.</span></span>

## <a name="device-support"></a><span data-ttu-id="6c3d2-119">Suporte a dispositivos</span><span class="sxs-lookup"><span data-stu-id="6c3d2-119">Device support</span></span>

<table>
<tr>
<th><span data-ttu-id="6c3d2-120">Course</span><span class="sxs-lookup"><span data-stu-id="6c3d2-120">Course</span></span></th><th style="width:150px"> <span data-ttu-id="6c3d2-121"><a href="hololens-hardware-details.md">HoloLens</a></span><span class="sxs-lookup"><span data-stu-id="6c3d2-121"><a href="hololens-hardware-details.md">HoloLens</a></span></span></th><th style="width:150px"> <span data-ttu-id="6c3d2-122"><a href="immersive-headset-hardware-details.md">Headsets imersivos</a></span><span class="sxs-lookup"><span data-stu-id="6c3d2-122"><a href="immersive-headset-hardware-details.md">Immersive headsets</a></span></span></th>
</tr><tr>
<td><span data-ttu-id="6c3d2-123">Sr Sharing 250: os headsets de HoloLens e de imersão</span><span class="sxs-lookup"><span data-stu-id="6c3d2-123">MR Sharing 250: HoloLens and immersive headsets</span></span></td><td style="text-align: center;"> <span data-ttu-id="6c3d2-124">✔️</span><span class="sxs-lookup"><span data-stu-id="6c3d2-124">✔️</span></span></td><td style="text-align: center;"> <span data-ttu-id="6c3d2-125">✔️</span><span class="sxs-lookup"><span data-stu-id="6c3d2-125">✔️</span></span></td>
</tr>
</table>

## <a name="before-you-start"></a><span data-ttu-id="6c3d2-126">Antes de começar</span><span class="sxs-lookup"><span data-stu-id="6c3d2-126">Before you start</span></span>

### <a name="prerequisites"></a><span data-ttu-id="6c3d2-127">Pré-requisitos</span><span class="sxs-lookup"><span data-stu-id="6c3d2-127">Prerequisites</span></span>

* <span data-ttu-id="6c3d2-128">Um PC com Windows 10 com as [ferramentas de desenvolvimento necessárias](install-the-tools.md) e [configurado para dar suporte a um headset de imersão de realidade mista do Windows](https://docs.microsoft.com/windows/mixed-reality/enthusiast-guide/windows-mixed-reality-minimum-pc-hardware-compatibility-guidelines).</span><span class="sxs-lookup"><span data-stu-id="6c3d2-128">A Windows 10 PC with the [necessary development tools](install-the-tools.md) and [configured to support a Windows Mixed Reality immersive headset](https://docs.microsoft.com/windows/mixed-reality/enthusiast-guide/windows-mixed-reality-minimum-pc-hardware-compatibility-guidelines).</span></span>
* <span data-ttu-id="6c3d2-129">Um controlador Xbox que funciona com seu PC.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-129">An Xbox controller that works with your PC.</span></span>
* <span data-ttu-id="6c3d2-130">Pelo menos um dispositivo HoloLens e um headset de imersão.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-130">At least one HoloLens device and one immersive headset.</span></span>
* <span data-ttu-id="6c3d2-131">Uma rede que permite a difusão UDP para descoberta.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-131">A network which allows UDP Broadcast for discovery.</span></span>

### <a name="project-files"></a><span data-ttu-id="6c3d2-132">Arquivos de projeto</span><span class="sxs-lookup"><span data-stu-id="6c3d2-132">Project files</span></span>

* <span data-ttu-id="6c3d2-133">Baixe os [arquivos](https://github.com/Microsoft/MixedReality250/archive/master.zip) exigidos pelo projeto.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-133">Download the [files](https://github.com/Microsoft/MixedReality250/archive/master.zip) required by the project.</span></span> <span data-ttu-id="6c3d2-134">Extraia os arquivos para um local fácil de lembrar.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-134">Extract the files to an easy to remember location.</span></span>
* <span data-ttu-id="6c3d2-135">Este projeto requer [uma versão recomendada do Unity com o suporte do Windows Mixed Reality](install-the-tools.md).</span><span class="sxs-lookup"><span data-stu-id="6c3d2-135">This project requires the [a recommended version of Unity with Windows Mixed Reality support](install-the-tools.md).</span></span>

>[!NOTE]
><span data-ttu-id="6c3d2-136">Se você quiser examinar o código-fonte antes de baixá-lo, ele [estará disponível no GitHub](https://github.com/Microsoft/MixedReality250).</span><span class="sxs-lookup"><span data-stu-id="6c3d2-136">If you want to look through the source code before downloading, it's [available on GitHub](https://github.com/Microsoft/MixedReality250).</span></span>

## <a name="chapter-1---holo-world"></a><span data-ttu-id="6c3d2-137">Capítulo 1 – holo World</span><span class="sxs-lookup"><span data-stu-id="6c3d2-137">Chapter 1 - Holo World</span></span>

>[!VIDEO https://www.youtube.com/embed/IC0rp6rLiEc]

### <a name="objectives"></a><span data-ttu-id="6c3d2-138">Objetivos</span><span class="sxs-lookup"><span data-stu-id="6c3d2-138">Objectives</span></span>

<span data-ttu-id="6c3d2-139">Verifique se o ambiente de desenvolvimento está pronto para ser usado com um projeto simples.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-139">Make sure the development environment is ready to go with a simple project.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="6c3d2-140">O que iremos criar</span><span class="sxs-lookup"><span data-stu-id="6c3d2-140">What we will build</span></span>

<span data-ttu-id="6c3d2-141">Um aplicativo que mostra um holograma sobre o HoloLens ou um headset de imersão de realidade mista do Windows.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-141">An application that shows a hologram on either HoloLens or a Windows Mixed Reality immersive headset.</span></span>

### <a name="steps"></a><span data-ttu-id="6c3d2-142">Etapas</span><span class="sxs-lookup"><span data-stu-id="6c3d2-142">Steps</span></span>

* <span data-ttu-id="6c3d2-143">Abra o Unity.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-143">Open Unity.</span></span>
    * <span data-ttu-id="6c3d2-144">Selecione **abrir**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-144">Select **Open**.</span></span>
    * <span data-ttu-id="6c3d2-145">Navegue até onde você extraiu os arquivos de projeto.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-145">Navigate to where you extracted the project files.</span></span>
    * <span data-ttu-id="6c3d2-146">Clique em **Selecionar Pasta**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-146">Click **Select Folder**.</span></span>
    * <span data-ttu-id="6c3d2-147">*Levará algum tempo para que o Unity processe o projeto pela primeira vez.*</span><span class="sxs-lookup"><span data-stu-id="6c3d2-147">*It will take a little while for Unity to process the project the first time.*</span></span>
* <span data-ttu-id="6c3d2-148">Verifique se a realidade misturada está habilitada no Unity.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-148">Check that Mixed Reality is enabled in Unity.</span></span>
    * <span data-ttu-id="6c3d2-149">Abra a caixa de diálogo Configurações de compilação (**Control + Shift + B** ou **arquivo > configurações de Build...** ).</span><span class="sxs-lookup"><span data-stu-id="6c3d2-149">Open the build settings dialog (**Control+Shift+B** or **File > Build Settings...**).</span></span>
    * <span data-ttu-id="6c3d2-150">Selecione **plataforma universal do Windows** , em seguida, clique em **alternar plataforma**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-150">Select **Universal Windows Platform** then click **Switch Platform**.</span></span>
    * <span data-ttu-id="6c3d2-151">Selecione **Editar configurações do Player >** .</span><span class="sxs-lookup"><span data-stu-id="6c3d2-151">Select **Edit>Player Settings**.</span></span>
    * <span data-ttu-id="6c3d2-152">No painel **Inspetor** no lado direito, expanda Configurações de **XR**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-152">In the **Inspector** panel on the right hand side, expand **XR Settings**.</span></span>
    * <span data-ttu-id="6c3d2-153">Verifique a caixa **suporte à realidade virtual** .</span><span class="sxs-lookup"><span data-stu-id="6c3d2-153">Check the **Virtual Reality Supported** box.</span></span>
    * <span data-ttu-id="6c3d2-154">*A realidade mista do Windows deve ser o SDK da realidade virtual.*</span><span class="sxs-lookup"><span data-stu-id="6c3d2-154">*Windows Mixed Reality should be the Virtual Reality SDK.*</span></span>
* <span data-ttu-id="6c3d2-155">Crie uma cena.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-155">Create a scene.</span></span>
    * <span data-ttu-id="6c3d2-156">Na **hierarquia** , clique na **câmera principal** selecionar **excluir**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-156">In the **Hierarchy** right click **Main Camera** select **Delete**.</span></span>
    * <span data-ttu-id="6c3d2-157">Em **HoloToolkit > entrada > pré-fabricados** arraste **MixedRealityCameraParent** para a **hierarquia**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-157">From **HoloToolkit > Input > Prefabs** drag **MixedRealityCameraParent** to the **Hierarchy**.</span></span>
* <span data-ttu-id="6c3d2-158">Adicionar hologramas à cena</span><span class="sxs-lookup"><span data-stu-id="6c3d2-158">Add Holograms to the scene</span></span>
    * <span data-ttu-id="6c3d2-159">Em **AppPrefabs** , arraste **Skybox** para a **exibição cena**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-159">From **AppPrefabs** drag **Skybox** to the **Scene View**.</span></span>
    * <span data-ttu-id="6c3d2-160">De **AppPrefabs** , arraste **os gerentes** para a **hierarquia**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-160">From **AppPrefabs** drag **Managers** to the **Hierarchy**.</span></span>
    * <span data-ttu-id="6c3d2-161">Da **ilha** de arrastar **AppPrefabs** para a **hierarquia**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-161">From **AppPrefabs** drag **Island** to the **Hierarchy**.</span></span>
* <span data-ttu-id="6c3d2-162">Salvar e compilar</span><span class="sxs-lookup"><span data-stu-id="6c3d2-162">Save And build</span></span>
    * <span data-ttu-id="6c3d2-163">Salvar ( **controle + S** ou **arquivo > salvar cena**)</span><span class="sxs-lookup"><span data-stu-id="6c3d2-163">Save (either **Control+S** or **File > Save Scene**)</span></span>
    * <span data-ttu-id="6c3d2-164">Como essa é uma nova cena, você precisará nomeá-la.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-164">Since this is a new scene, you'll need to name it.</span></span> <span data-ttu-id="6c3d2-165">O nome não é importante, mas usamos SharedMixedReality.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-165">Name doesn't matter, but we use SharedMixedReality.</span></span>
* <span data-ttu-id="6c3d2-166">Exportar para o Visual Studio</span><span class="sxs-lookup"><span data-stu-id="6c3d2-166">Export To Visual Studio</span></span>
    * <span data-ttu-id="6c3d2-167">Abra o menu Compilar (**Control + Shift + B** ou **arquivos > configurações de Build**)</span><span class="sxs-lookup"><span data-stu-id="6c3d2-167">Open the build menu (**Control+Shift+B** or **File > Build Settings**)</span></span>
    * <span data-ttu-id="6c3d2-168">Clique em **Adicionar abrir cenas.**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-168">Click **Add Open Scenes.**</span></span>
    * <span data-ttu-id="6c3d2-169">Verificar **projetos C# do Unity**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-169">Check **Unity C# Projects**</span></span>
    * <span data-ttu-id="6c3d2-170">Clique em **Compilar**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-170">Click **Build**.</span></span>
    * <span data-ttu-id="6c3d2-171">Na janela Explorador de arquivos que aparece, crie uma nova pasta chamada **aplicativo**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-171">In the file explorer window that appears, create a New Folder named **App**.</span></span>
    * <span data-ttu-id="6c3d2-172">Clique uma vez na pasta do **aplicativo** .</span><span class="sxs-lookup"><span data-stu-id="6c3d2-172">Single click the **App** folder.</span></span>
    * <span data-ttu-id="6c3d2-173">Pressione **Selecionar pasta.**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-173">Press **Select Folder.**</span></span>
    * <span data-ttu-id="6c3d2-174">**Aguarde a conclusão da compilação**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-174">**Wait for the build to complete**</span></span>
    * <span data-ttu-id="6c3d2-175">Na janela Explorador de arquivos que aparece, navegue até a pasta do **aplicativo** .</span><span class="sxs-lookup"><span data-stu-id="6c3d2-175">In the file explorer window that appears, navigate into the **App** folder.</span></span>
    * <span data-ttu-id="6c3d2-176">Clique duas vezes em **SharedMixedReality. sln** para iniciar o Visual Studio</span><span class="sxs-lookup"><span data-stu-id="6c3d2-176">Double-click **SharedMixedReality.sln** to launch Visual Studio</span></span>
* <span data-ttu-id="6c3d2-177">Compilar a partir do Visual Studio</span><span class="sxs-lookup"><span data-stu-id="6c3d2-177">Build From Visual Studio</span></span>
    * <span data-ttu-id="6c3d2-178">Usando o destino de alteração da barra de ferramentas superior para **liberar** e **x86**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-178">Using the top toolbar change target to **Release** and **x86**.</span></span>
    * <span data-ttu-id="6c3d2-179">Clique na seta ao lado de **computador local** e selecione **dispositivo** para implantar no HoloLens</span><span class="sxs-lookup"><span data-stu-id="6c3d2-179">Click the arrow next to **Local Machine** and select **Device** to deploy to HoloLens</span></span>
    * <span data-ttu-id="6c3d2-180">Clique na seta ao lado de **dispositivo** e selecione **computador local** para implantar para o headset de realidade misturada.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-180">Click the arrow next to **Device** and select **Local Machine** to deploy for the mixed reality headset.</span></span>
    * <span data-ttu-id="6c3d2-181">Clique em **depurar-> iniciar sem Depurar** ou **controlar + F5** para iniciar o aplicativo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-181">Click **Debug->Start Without Debugging** or **Control+F5** to start the application.</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="6c3d2-182">Aprofundando-se no código</span><span class="sxs-lookup"><span data-stu-id="6c3d2-182">Digging into the code</span></span>

<span data-ttu-id="6c3d2-183">No painel projeto, navegue até **Assets\HoloToolkit\Input\Scripts\Utilities** e clique duas vezes em **MixedRealityCameraManager.cs** para abri-lo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-183">In the project panel, navigate to **Assets\HoloToolkit\Input\Scripts\Utilities** and double click **MixedRealityCameraManager.cs** to open it.</span></span>

<span data-ttu-id="6c3d2-184">**Visão geral:** MixedRealityCameraManager.cs é um script simples que ajusta as configurações de nível de qualidade e de segundo plano com base no dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-184">**Overview:** MixedRealityCameraManager.cs is a simple script that adjusts quality level and background settings based on the device.</span></span> <span data-ttu-id="6c3d2-185">A chave aqui é HolographicSettings. IsDisplayOpaque, que permite que um script detecte se o dispositivo é um HoloLens (IsDisplayOpaque retorna false) ou um headset de imersão (IsDisplayOpaque retorna true).</span><span class="sxs-lookup"><span data-stu-id="6c3d2-185">Key here is HolographicSettings.IsDisplayOpaque, which allows a script to detect if the device is a HoloLens (IsDisplayOpaque returns false) or an immersive headset (IsDisplayOpaque returns true).</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="6c3d2-186">Aproveite seu progresso</span><span class="sxs-lookup"><span data-stu-id="6c3d2-186">Enjoy your progress</span></span>

<span data-ttu-id="6c3d2-187">Neste ponto, o aplicativo apenas renderizará um holograma.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-187">At this point the application will just render a hologram.</span></span> <span data-ttu-id="6c3d2-188">Adicionaremos interação com o holograma posteriormente.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-188">We will add interaction to the hologram later.</span></span> <span data-ttu-id="6c3d2-189">Ambos os dispositivos processarão o holograma da mesma forma.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-189">Both devices will render the hologram the same.</span></span> <span data-ttu-id="6c3d2-190">O headset de imersão também renderizará uma fundo azul céu e nuvens.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-190">The immersive headset will also render a blue sky and clouds background.</span></span>

## <a name="chapter-2---interaction"></a><span data-ttu-id="6c3d2-191">Capítulo 2-interação</span><span class="sxs-lookup"><span data-stu-id="6c3d2-191">Chapter 2 - Interaction</span></span>

>[!VIDEO https://www.youtube.com/embed/Lrb1y4sQRvI]

### <a name="objectives"></a><span data-ttu-id="6c3d2-192">Objetivos</span><span class="sxs-lookup"><span data-stu-id="6c3d2-192">Objectives</span></span>

<span data-ttu-id="6c3d2-193">Mostre como tratar a entrada para um aplicativo do Windows Mixed Reality.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-193">Show how to handle input for a Windows Mixed Reality application.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="6c3d2-194">O que iremos criar</span><span class="sxs-lookup"><span data-stu-id="6c3d2-194">What we will build</span></span>

<span data-ttu-id="6c3d2-195">Criando o aplicativo no capítulo 1, adicionaremos funcionalidade para permitir que o usuário pegue o holograma e coloque-o em uma superfície do mundo real no HoloLens ou em uma tabela virtual em um headset de imersão.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-195">Building on the application from chapter 1, we will add functionality to allow the user to pick up the hologram and place it on a real world surface in HoloLens or on a virtual table in an immersive headset.</span></span>

<span data-ttu-id="6c3d2-196">**Atualizador de entrada:** No HoloLens, o gesto de seleção é o **toque de ar**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-196">**Input Refresher:** On HoloLens the select gesture is the **air tap**.</span></span> <span data-ttu-id="6c3d2-197">Em headsets de imersão, usaremos **o botão a** no controlador Xbox.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-197">On immersive headsets, we will use the **A** button on the Xbox controller.</span></span> <span data-ttu-id="6c3d2-198">Para obter mais informações, confira a [visão geral do modelo de interação](interaction-fundamentals.md).</span><span class="sxs-lookup"><span data-stu-id="6c3d2-198">For more information check out the [interaction model overview](interaction-fundamentals.md).</span></span>

### <a name="steps"></a><span data-ttu-id="6c3d2-199">Etapas</span><span class="sxs-lookup"><span data-stu-id="6c3d2-199">Steps</span></span>

* <span data-ttu-id="6c3d2-200">Adicionar Gerenciador de entrada</span><span class="sxs-lookup"><span data-stu-id="6c3d2-200">Add Input manager</span></span>
    * <span data-ttu-id="6c3d2-201">Em **HoloToolkit > entrada > pré-fabricados** arraste **InputManager** para **hierarquia** como um filho de **gerentes**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-201">From **HoloToolkit > Input > Prefabs** drag **InputManager** to **Hierarchy** as a child of **Managers**.</span></span>
    * <span data-ttu-id="6c3d2-202">From **HoloToolkit > entrada > pré-fabricados >** cursor arrastar **cursor** para **hierarquia**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-202">From **HoloToolkit > Input > Prefabs > Cursor** drag **Cursor** to **Hierarchy**.</span></span>
* <span data-ttu-id="6c3d2-203">Adicionar mapeamento espacial</span><span class="sxs-lookup"><span data-stu-id="6c3d2-203">Add Spatial Mapping</span></span>
    * <span data-ttu-id="6c3d2-204">Em **HoloToolkit > SpatialMapping > pré-fabricados** arraste **SpatialMapping** para **hierarquia**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-204">From **HoloToolkit > SpatialMapping > Prefabs** drag **SpatialMapping** to **Hierarchy**.</span></span>
* <span data-ttu-id="6c3d2-205">Adicionar Playspace virtual</span><span class="sxs-lookup"><span data-stu-id="6c3d2-205">Add Virtual Playspace</span></span>
    * <span data-ttu-id="6c3d2-206">Em **hierarquia** , expanda **MixedRealityCameraParent** selecionar **limite**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-206">In **Hierarchy** expand **MixedRealityCameraParent** select **Boundary**</span></span>
    * <span data-ttu-id="6c3d2-207">No painel **Inspetor** , marque a caixa para habilitar o **limite**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-207">In **Inspector** panel check the box to enable **Boundary**</span></span>
    * <span data-ttu-id="6c3d2-208">Em **AppPrefabs** , arraste **VRRoom** para **hierarquia**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-208">From **AppPrefabs** drag **VRRoom** to **Hierarchy**.</span></span>
* <span data-ttu-id="6c3d2-209">Adicionar WorldAnchorManager</span><span class="sxs-lookup"><span data-stu-id="6c3d2-209">Add WorldAnchorManager</span></span>
    * <span data-ttu-id="6c3d2-210">Em **hierarquia**, selecione **gerentes**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-210">In **Hierarchy**, Select **Managers**.</span></span>
    * <span data-ttu-id="6c3d2-211">No **Inspetor**, clique em **Adicionar componente**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-211">In **Inspector**, click **Add Component**.</span></span>
    * <span data-ttu-id="6c3d2-212">Digite **gerente de âncora mundial**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-212">Type **World Anchor Manager**.</span></span>
    * <span data-ttu-id="6c3d2-213">Selecione **gerente de âncora mundial** para adicioná-lo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-213">Select **World Anchor Manager** to add it.</span></span>
* <span data-ttu-id="6c3d2-214">Adicionar TapToPlace à ilha</span><span class="sxs-lookup"><span data-stu-id="6c3d2-214">Add TapToPlace to the Island</span></span>
    * <span data-ttu-id="6c3d2-215">Em **hierarquia**, expanda **ilha**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-215">In **Hierarchy**, expand **Island**.</span></span>
    * <span data-ttu-id="6c3d2-216">Selecione **MixedRealityLand**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-216">Select **MixedRealityLand**.</span></span>
    * <span data-ttu-id="6c3d2-217">No **Inspetor**, clique em **Adicionar componente**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-217">In **Inspector**, click **Add Component**.</span></span>
    * <span data-ttu-id="6c3d2-218">Digite **toque para inserir** e selecione-o.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-218">Type **Tap To Place** and select it.</span></span>
    * <span data-ttu-id="6c3d2-219">Verifique o **pai ao tocar**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-219">Check **Place Parent On Tap**.</span></span>
    * <span data-ttu-id="6c3d2-220">Defina **deslocamento de posicionamento** como **(0, 0,1, 0)** .</span><span class="sxs-lookup"><span data-stu-id="6c3d2-220">Set **Placement Offset** to **(0, 0.1, 0)**.</span></span>
* <span data-ttu-id="6c3d2-221">Salvar e compilar como antes</span><span class="sxs-lookup"><span data-stu-id="6c3d2-221">Save and Build as before</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="6c3d2-222">Aprofundando-se no código</span><span class="sxs-lookup"><span data-stu-id="6c3d2-222">Digging into the code</span></span>

<span data-ttu-id="6c3d2-223">**Script 1-GamepadInput.cs**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-223">**Script 1 - GamepadInput.cs**</span></span>

<span data-ttu-id="6c3d2-224">No painel projeto, navegue até **Assets\HoloToolkit\Input\Scripts\InputSources** e clique duas vezes em **GamepadInput.cs** para abri-lo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-224">In the project panel navigate to **Assets\HoloToolkit\Input\Scripts\InputSources** and double click **GamepadInput.cs** to open it.</span></span> <span data-ttu-id="6c3d2-225">No mesmo caminho no painel de projeto, também clique duas vezes em **InteractionSourceInputSource.cs**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-225">From the same path in the project panel, also double click **InteractionSourceInputSource.cs**.</span></span>

<span data-ttu-id="6c3d2-226">Observe que ambos os scripts têm uma classe base comum, BaseInputSource.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-226">Note that both scripts have a common base class, BaseInputSource.</span></span>

<span data-ttu-id="6c3d2-227">BaseInputSource mantém uma referência a um InputManager, que permite que um script dispare eventos.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-227">BaseInputSource keeps a reference to an InputManager, which allows a script to trigger events.</span></span> <span data-ttu-id="6c3d2-228">Nesse caso, o evento InputClicked é relevante.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-228">In this case, the InputClicked event is relevant.</span></span> <span data-ttu-id="6c3d2-229">Será importante lembrar-se de quando chegarmos ao script 2, TapToPlace.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-229">This will be important to remember when we get to script 2, TapToPlace.</span></span> <span data-ttu-id="6c3d2-230">No caso do GamePadInput, pesquisamos um botão no controlador a ser pressionado e, em seguida, geramos o evento InputClicked.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-230">In the case of GamePadInput, we poll for the A button on the controller to be pressed, then we raise the InputClicked event.</span></span> <span data-ttu-id="6c3d2-231">No caso do InteractionSourceInputSource, geramos o evento InputClicked em resposta ao TappedEvent.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-231">In the case of InteractionSourceInputSource, we raise the InputClicked event in response to the TappedEvent.</span></span>

<span data-ttu-id="6c3d2-232">**Script 2-TapToPlace.cs**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-232">**Script 2 - TapToPlace.cs**</span></span>

<span data-ttu-id="6c3d2-233">No painel projeto, navegue até **Assets\HoloToolkit\SpatialMapping\Scripts** e clique duas vezes em **TapToPlace.cs** para abri-lo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-233">In the project panel navigate to **Assets\HoloToolkit\SpatialMapping\Scripts** and double click **TapToPlace.cs** to open it.</span></span>

<span data-ttu-id="6c3d2-234">A primeira coisa que muitos desenvolvedores desejam implementar ao criar um aplicativo Holographic está movendo hologramas com entrada de gestos.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-234">The first thing many developers want to implement when creating a Holographic application is moving Holograms with gesture input.</span></span> <span data-ttu-id="6c3d2-235">Assim, fizemos um comentário completo sobre esse script.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-235">As such, we've endeavored to thoroughly comment this script.</span></span> <span data-ttu-id="6c3d2-236">Algumas coisas valem a pena destacar este tutorial.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-236">A few things are worth highlighting for this tutorial.</span></span>

<span data-ttu-id="6c3d2-237">Primeiro, observe que TapToPlace implementa IInputClickHandler.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-237">First, note that TapToPlace implements IInputClickHandler.</span></span> <span data-ttu-id="6c3d2-238">IInputClickHandler expõe as funções que manipulam o evento InputClicked gerado por GamePadInput.cs ou InteractionSourceInputSource.cs.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-238">IInputClickHandler exposes the functions that handle the InputClicked event raised by GamePadInput.cs or InteractionSourceInputSource.cs.</span></span> <span data-ttu-id="6c3d2-239">OnInputClicked é chamado quando um BaseInputSource detecta um clique enquanto o objeto com TapToPlace está em foco.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-239">OnInputClicked is called when a BaseInputSource detects a click while the object with TapToPlace is in focus.</span></span> <span data-ttu-id="6c3d2-240">Ao tocar no HoloLens ou pressionar o botão a no controlador Xbox, o evento será disparado.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-240">Either airtapping on HoloLens or pressing the A button on the Xbox controller will trigger the event.</span></span>

<span data-ttu-id="6c3d2-241">O segundo é que o código seja executado na atualização para ver se uma superfície está sendo examinada para que possamos posicionar o objeto de jogo em uma superfície, como uma tabela.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-241">Second is the code be executed in update to see if a surface is being looked at so we can place the game object on a surface, like a table.</span></span> <span data-ttu-id="6c3d2-242">O headset de imersão não tem um conceito de superfícies reais, portanto, o objeto que representa a tabela superior (Vroom > TableThingy > Cube) foi marcado com a camada física SpatialMapping, portanto, o Ray Cast na atualização irá colidir com a tabela virtual superior.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-242">The immersive headset doesn't have a concept of real surfaces, so the object that represents the table top (Vroom > TableThingy > Cube) has been marked with the SpatialMapping physics layer, so the ray cast in Update will collide with the virtual table top.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="6c3d2-243">Aproveite seu progresso</span><span class="sxs-lookup"><span data-stu-id="6c3d2-243">Enjoy your progress</span></span>

<span data-ttu-id="6c3d2-244">Desta vez, você pode selecionar a ilha para movê-la.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-244">This time you can select the island to move it.</span></span> <span data-ttu-id="6c3d2-245">No HoloLens, você pode mover a ilha para uma superfície real.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-245">On HoloLens you can move the island to a real surface.</span></span> <span data-ttu-id="6c3d2-246">No headset de imersão, você pode mover a ilha para a tabela virtual que adicionamos.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-246">In the immersive headset you can move the island to the virtual table we added.</span></span>

## <a name="chapter-3---sharing"></a><span data-ttu-id="6c3d2-247">Capítulo 3 – compartilhando</span><span class="sxs-lookup"><span data-stu-id="6c3d2-247">Chapter 3 - Sharing</span></span>

>[!VIDEO https://www.youtube.com/embed/1diycJvxfDc]

### <a name="objectives"></a><span data-ttu-id="6c3d2-248">Objetivos</span><span class="sxs-lookup"><span data-stu-id="6c3d2-248">Objectives</span></span>

<span data-ttu-id="6c3d2-249">Verifique se a rede está configurada corretamente e detalhe como as âncoras espaciais são compartilhadas entre os dispositivos.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-249">Ensure that the network is correctly configured and detail how spatial anchors are shared between devices.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="6c3d2-250">O que iremos criar</span><span class="sxs-lookup"><span data-stu-id="6c3d2-250">What we will build</span></span>

<span data-ttu-id="6c3d2-251">Converteremos nosso projeto em um projeto de vários participantes.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-251">We will convert our project to a multiplayer project.</span></span> <span data-ttu-id="6c3d2-252">Adicionaremos a interface do usuário e a lógica para hospedar ou ingressar em sessões.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-252">We will add UI and logic to host or join sessions.</span></span> <span data-ttu-id="6c3d2-253">Os usuários do HoloLens verão um ao outro na sessão com nuvens em seus cabeçotes e os usuários do headset de imersão têm nuvens perto de onde está a âncora.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-253">HoloLens users will see each other in the session with clouds over their heads, and immersive headset users have clouds near to where the anchor is.</span></span> <span data-ttu-id="6c3d2-254">Os usuários em headsets de imersão verão os usuários do HoloLens em relação à origem da cena.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-254">Users in the immersive headsets will see the HoloLens users relative to the origin of the scene.</span></span> <span data-ttu-id="6c3d2-255">Os usuários do HoloLens verão o holograma da ilha no mesmo local.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-255">HoloLens users will all see the hologram of the island in the same place.</span></span> <span data-ttu-id="6c3d2-256">É importante observar que os usuários nos headsets de imersão não estarão na ilha durante este capítulo, mas se comportarão de forma semelhante ao HoloLens, com uma visão de olho da ilha.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-256">It is key to note that the users in the immersive headsets will not be on the island during this chapter, but will behave very similarly to HoloLens, with a birds eye view of the island.</span></span>

### <a name="steps"></a><span data-ttu-id="6c3d2-257">Etapas</span><span class="sxs-lookup"><span data-stu-id="6c3d2-257">Steps</span></span>

* <span data-ttu-id="6c3d2-258">Remover ilha e VRRoom</span><span class="sxs-lookup"><span data-stu-id="6c3d2-258">Remove Island and VRRoom</span></span>
    * <span data-ttu-id="6c3d2-259">Em **hierarquia** , clique com o botão direito do mouse em **ilha** selecionar **excluir**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-259">In **Hierarchy** right-click **Island** select **Delete**</span></span>
    * <span data-ttu-id="6c3d2-260">Em **hierarquia** , clique com o botão direito do mouse em **VRRoom** selecionar **excluir**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-260">In **Hierarchy** right-click **VRRoom** select **Delete**</span></span>
* <span data-ttu-id="6c3d2-261">Adicionar Usland</span><span class="sxs-lookup"><span data-stu-id="6c3d2-261">Add Usland</span></span>
    * <span data-ttu-id="6c3d2-262">Em **AppPrefabs** , arraste **Usland** para **hierarquia**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-262">From **AppPrefabs** drag **Usland** to **Hierarchy**.</span></span>
* <span data-ttu-id="6c3d2-263">Em **AppPrefabs** , arraste cada um dos seguintes para **hierarquia**:</span><span class="sxs-lookup"><span data-stu-id="6c3d2-263">From **AppPrefabs** drag each of the following to **Hierarchy**:</span></span>
    * <span data-ttu-id="6c3d2-264">**UNETSharingStage**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-264">**UNETSharingStage**</span></span>
    * <span data-ttu-id="6c3d2-265">**UNetAnchorRoot**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-265">**UNetAnchorRoot**</span></span>
    * <span data-ttu-id="6c3d2-266">**UIContainer**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-266">**UIContainer**</span></span>
    * <span data-ttu-id="6c3d2-267">**DebugPanelButton**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-267">**DebugPanelButton**</span></span>
* <span data-ttu-id="6c3d2-268">Salvar e compilar como antes</span><span class="sxs-lookup"><span data-stu-id="6c3d2-268">Save and Build as before</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="6c3d2-269">Aprofundando-se no código</span><span class="sxs-lookup"><span data-stu-id="6c3d2-269">Digging into the code</span></span>

<span data-ttu-id="6c3d2-270">No painel projeto, navegue até **Assets\AppPrefabs\Support\SharingWithUnet\Scripts** e clique duas vezes em **UnetAnchorManager.cs**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-270">In the project panel, navigate to **Assets\AppPrefabs\Support\SharingWithUnet\Scripts** and double-click on **UnetAnchorManager.cs**.</span></span> <span data-ttu-id="6c3d2-271">A capacidade de um HoloLens compartilhar informações de rastreamento com outro HoloLens, de modo que ambos os dispositivos possam compartilhar o mesmo espaço é quase mágico.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-271">The ability for one HoloLens to share tracking information with another HoloLens such that both devices can share the same space is near magical.</span></span> <span data-ttu-id="6c3d2-272">O poder da realidade misturada vem ativo quando duas ou mais pessoas podem colaborar usando os mesmos dados digitais.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-272">The power of mixed reality comes alive when two or more people can collaborate using the same digital data.</span></span>

<span data-ttu-id="6c3d2-273">Algumas coisas para destacar esse script:</span><span class="sxs-lookup"><span data-stu-id="6c3d2-273">A few things to point out in this script:</span></span>

<span data-ttu-id="6c3d2-274">Na função iniciar, observe a verificação de **IsDisplayOpaque**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-274">In the start function, notice the check for **IsDisplayOpaque**.</span></span> <span data-ttu-id="6c3d2-275">Nesse caso, vamos fingir que a âncora é estabelecida.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-275">In this case, we pretend that the Anchor is established.</span></span> <span data-ttu-id="6c3d2-276">Isso ocorre porque os headsets de imersão não expõem uma maneira de importar ou exportar âncoras.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-276">This is because the immersive headsets do not expose a way to import or export anchors.</span></span> <span data-ttu-id="6c3d2-277">No entanto, se estivermos executando em um HoloLens, esse script implementará âncoras de compartilhamento entre os dispositivos.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-277">If we are running on a HoloLens, however, this script implements sharing anchors between the devices.</span></span> <span data-ttu-id="6c3d2-278">O dispositivo que inicia a sessão criará uma âncora para exportação.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-278">The device that starts the session will create an anchor for exporting.</span></span> <span data-ttu-id="6c3d2-279">O dispositivo que ingressa em uma sessão solicitará a âncora do dispositivo que iniciou a sessão.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-279">The device that joins a session will request the anchor from the device that started the session.</span></span>

<span data-ttu-id="6c3d2-280">**Exportar**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-280">**Exporting:**</span></span>

<span data-ttu-id="6c3d2-281">Quando um usuário cria uma sessão, NetworkDiscoveryWithAnchors chamará a função createanchor UNETAnchorManagers.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-281">When a user creates a session, NetworkDiscoveryWithAnchors will call UNETAnchorManagers CreateAnchor function.</span></span> <span data-ttu-id="6c3d2-282">Vamos seguir o fluxo de createanchor.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-282">Let's follow CreateAnchor flow.</span></span>

<span data-ttu-id="6c3d2-283">Começamos fazendo algumas realizações, limpando todos os dados que poderemos ter coletado para âncoras anteriores.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-283">We start by doing some housekeeping, clearing out any data we may have collected for previous anchors.</span></span> <span data-ttu-id="6c3d2-284">Em seguida, verificamos se há uma âncora em cache a ser carregada.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-284">Then we check if there is a cached anchor to load.</span></span> <span data-ttu-id="6c3d2-285">Os dados de âncora tendem a estar entre 5 e 20 MB, portanto, reutilizar âncoras em cache pode economizar na quantidade de dados que precisamos transferir pela rede.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-285">The anchor data tends to be between 5 and 20 MB, so reusing cached anchors can save on the amount of data we need to transfer over the network.</span></span> <span data-ttu-id="6c3d2-286">Veremos como isso funciona um pouco mais tarde.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-286">We'll see how this works a bit later.</span></span> <span data-ttu-id="6c3d2-287">Mesmo que estejamos reutilizando a âncora, precisamos obter os dados de âncora prontos caso um novo cliente ingresse que não tenha a âncora.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-287">Even if we are reusing the anchor, we need to get the anchor data ready in case a new client joins that doesn't have the anchor.</span></span>

<span data-ttu-id="6c3d2-288">Falando em colocar os dados de ancoragem prontos, a classe WorldAnchorTransferBatch expõe a funcionalidade para preparar dados âncora para enviar para outro dispositivo ou aplicativo e a funcionalidade para importar os dados de âncora.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-288">Speaking of getting the anchor data ready, the WorldAnchorTransferBatch class exposes the functionality to prepare anchor data for sending to another device or application and the functionality to import the anchor data.</span></span> <span data-ttu-id="6c3d2-289">Como estamos no caminho de exportação, adicionaremos nossa âncora ao WorldAnchorTransferBatch e chamarei a função ExportAsync.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-289">Since we're on the export path, we will add our anchor to the WorldAnchorTransferBatch and call the ExportAsync function.</span></span> <span data-ttu-id="6c3d2-290">Em seguida, ExportAsync chamará o retorno de chamada WriteBuffer, pois ele gera dados para exportação.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-290">ExportAsync will then call the WriteBuffer callback as it generates data for export.</span></span> <span data-ttu-id="6c3d2-291">Quando todos os dados forem exportados, ExportComplete será chamado.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-291">When all of the data has been exported ExportComplete will be called.</span></span> <span data-ttu-id="6c3d2-292">No WriteBuffer, adicionamos a parte dos dados a uma lista que mantemos para a exportação.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-292">In WriteBuffer we add the chunk of data to a list we keep for exporting.</span></span> <span data-ttu-id="6c3d2-293">No ExportComplete, convertemos a lista em uma matriz.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-293">In ExportComplete we convert the list to an array.</span></span> <span data-ttu-id="6c3d2-294">A variável anchorName também é definida, o que disparará outros dispositivos para solicitar a âncora se eles não o tiverem.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-294">The AnchorName variable is also set, which will trigger other devices to request the anchor if they don't have it.</span></span>

<span data-ttu-id="6c3d2-295">Em alguns casos, a âncora não será exportada ou criará poucos dados que tentaremos novamente.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-295">In some cases the anchor won't export or will create so little data that we will try again.</span></span> <span data-ttu-id="6c3d2-296">Aqui, basta chamar createanchor novamente.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-296">Here we just call CreateAnchor again.</span></span>

<span data-ttu-id="6c3d2-297">Uma função final no caminho de exportação é AnchorFoundRemotely.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-297">A final function in the export path is AnchorFoundRemotely.</span></span> <span data-ttu-id="6c3d2-298">Quando outro dispositivo encontrar a âncora, esse dispositivo dirá o host, e o host usará isso como um sinal de que a âncora é uma "boa âncora" e pode ser armazenada em cache.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-298">When another device finds the anchor, that device will tell the host, and the host will use that as a signal that the anchor is a "good anchor" and can be cached.</span></span>

<span data-ttu-id="6c3d2-299">**Importar**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-299">**Importing:**</span></span>

<span data-ttu-id="6c3d2-300">Quando um HoloLens ingressa em uma sessão, ele precisa importar uma âncora.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-300">When a HoloLens joins a session, it needs to import an anchor.</span></span> <span data-ttu-id="6c3d2-301">Na função Update do UNETAnchorManager, o ancoraname é sondado.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-301">In UNETAnchorManager's Update function, the AnchorName is polled.</span></span> <span data-ttu-id="6c3d2-302">Quando o nome da âncora é alterado, o processo de importação é iniciado.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-302">When the anchor name changes, the import process begins.</span></span> <span data-ttu-id="6c3d2-303">Primeiro, tentamos carregar a âncora com o nome especificado do repositório de âncora local.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-303">First, we try to load the anchor with the specified name from the local anchor store.</span></span> <span data-ttu-id="6c3d2-304">Se já o tiver, podemos usá-lo sem baixar os dados novamente.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-304">If we already have it, we can use it without downloading the data again.</span></span> <span data-ttu-id="6c3d2-305">Se não tivermos, chamamos o WaitForAnchor, que iniciará o download.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-305">If we don't have it, then we call WaitForAnchor which will initiate the download.</span></span>

<span data-ttu-id="6c3d2-306">Quando o download for concluído, NetworkTransmitter_dataReadyEvent será chamado.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-306">When the download is completed, NetworkTransmitter_dataReadyEvent is called.</span></span> <span data-ttu-id="6c3d2-307">Isso sinalizará o loop de atualização para chamar ImportAsync com os dados baixados.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-307">This will signal the Update loop to call ImportAsync with the downloaded data.</span></span> <span data-ttu-id="6c3d2-308">ImportAsync chamará ImportComplete quando o processo de importação for concluído.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-308">ImportAsync will call ImportComplete when the import process is complete.</span></span> <span data-ttu-id="6c3d2-309">Se a importação for bem-sucedida, a âncora será salva no repositório local do Player.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-309">If the import is successful, the anchor will be saved in the local player store.</span></span> <span data-ttu-id="6c3d2-310">PlayerController.cs realmente faz a chamada para AnchorFoundRemotely para permitir que o host saiba que uma boa âncora foi estabelecida.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-310">PlayerController.cs actually makes the call to AnchorFoundRemotely to let the host know that a good anchor has been established.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="6c3d2-311">Aproveite seu progresso</span><span class="sxs-lookup"><span data-stu-id="6c3d2-311">Enjoy your progress</span></span>

<span data-ttu-id="6c3d2-312">Desta vez, um usuário com um HoloLens hospedará uma sessão usando o botão **iniciar sessão** na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-312">This time a user with a HoloLens will host a session using the **start session** button in the UI.</span></span> <span data-ttu-id="6c3d2-313">Outros usuários, tanto no HoloLens quanto em um headset de imersão, selecionarão a sessão e, em seguida, selecionarão o botão de **sessão de junção** na interface do usuário.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-313">Other users, both on HoloLens or an immersive headset, will select the session and then select the **join session** button in the UI.</span></span> <span data-ttu-id="6c3d2-314">Se você tiver várias pessoas com dispositivos de HoloLens, elas terão nuvens vermelhas sobre suas cabeças.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-314">If you have multiple people with HoloLens devices, they will have red clouds over their heads.</span></span> <span data-ttu-id="6c3d2-315">Também haverá uma nuvem azul para cada headset de imersão, mas as nuvens azuis não estarão acima dos headsets, pois os headsets não estão tentando encontrar o mesmo espaço de coordenadas do mundo que os dispositivos HoloLens.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-315">There will also be a blue cloud for each immersive headset, but the blue clouds will not be above the headsets, as the headsets are not trying to find the same world coordinate space as the HoloLens devices.</span></span>

<span data-ttu-id="6c3d2-316">Esse ponto no projeto é um aplicativo de compartilhamento independente; Ele não faz muita coisa e pode agir como uma linha de base.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-316">This point in the project is a contained sharing application; it doesn't do very much, and could act as a baseline.</span></span> <span data-ttu-id="6c3d2-317">Nos próximos capítulos, começaremos a criar uma experiência para as pessoas gostarem.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-317">In the next chapters, we will start building an experience for people to enjoy.</span></span> <span data-ttu-id="6c3d2-318">Para obter mais orientações sobre o design de experiência compartilhada, acesse aqui.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-318">To get further guidance on shared experience design, go here.</span></span>

## <a name="chapter-4---immersion-and-teleporting"></a><span data-ttu-id="6c3d2-319">Capítulo 4-imersão e teleportabilidade</span><span class="sxs-lookup"><span data-stu-id="6c3d2-319">Chapter 4 - Immersion and teleporting</span></span>

>[!VIDEO https://www.youtube.com/embed/kUHZ5tCOfvY]

### <a name="objectives"></a><span data-ttu-id="6c3d2-320">Objetivos</span><span class="sxs-lookup"><span data-stu-id="6c3d2-320">Objectives</span></span>

<span data-ttu-id="6c3d2-321">Atenda à experiência de cada tipo de dispositivo de realidade misturada.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-321">Cater the experience to each type of mixed reality device.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="6c3d2-322">O que iremos criar</span><span class="sxs-lookup"><span data-stu-id="6c3d2-322">What we will build</span></span>

<span data-ttu-id="6c3d2-323">Atualizaremos o aplicativo para colocar os usuários de headsets imersivas na ilha com uma exibição imersiva.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-323">We will update the application to put immersive headset users on the island with an immersive view.</span></span> <span data-ttu-id="6c3d2-324">Os usuários do HoloLens ainda terão a visão panorâmica da ilha.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-324">HoloLens users will still have the bird's eye view of the island.</span></span> <span data-ttu-id="6c3d2-325">Os usuários de cada tipo de dispositivo podem ver outros usuários como aparecem no mundo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-325">Users of each device type can see other users as they appear in the world.</span></span> <span data-ttu-id="6c3d2-326">Por exemplo, os usuários de headsets de imersão podem ver os outros avatars em outros caminhos na ilha e eles veem os usuários do HoloLens como nuvens Giant acima da ilha.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-326">For instance, immersive headset users can see the other avatars on other paths on the island, and they see the HoloLens users as giant clouds above the island.</span></span> <span data-ttu-id="6c3d2-327">Os usuários do headset de imersão também verão o cursor do olhar Ray do usuário do HoloLens se o usuário do HoloLens estiver olhando para a ilha.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-327">Immersive headset users will also see the cursor of the HoloLens user's gaze ray if the HoloLens user is looking at the island.</span></span> <span data-ttu-id="6c3d2-328">Os usuários do HoloLens verão um avatar na ilha para representar cada usuário do headset de imersão.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-328">HoloLens users will see an avatar on the island to represent each immersive headset user.</span></span>

<span data-ttu-id="6c3d2-329">**Entrada atualizada para o dispositivo de imersão:**</span><span class="sxs-lookup"><span data-stu-id="6c3d2-329">**Updated Input for the Immersive device:**</span></span>

* <span data-ttu-id="6c3d2-330">Os botões do amortecedor esquerdo e do amortecedor direito no controlador Xbox giram o Player</span><span class="sxs-lookup"><span data-stu-id="6c3d2-330">The left bumper and right bumper buttons on the Xbox controller rotate the player</span></span>
* <span data-ttu-id="6c3d2-331">Manter o botão Y no controlador Xbox habilitará um cursor [teleport](navigating-the-windows-mixed-reality-home.md#getting-around-your-home) .</span><span class="sxs-lookup"><span data-stu-id="6c3d2-331">Holding the Y button on the Xbox controller will enable a [teleport](navigating-the-windows-mixed-reality-home.md#getting-around-your-home) cursor.</span></span> <span data-ttu-id="6c3d2-332">Se o cursor tiver um indicador de seta girando quando você liberar o botão Y, você será teleportado para o local do cursor.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-332">If the cursor has a spinning arrow indicator when you release the Y button, you will be teleported to the cursor's location.</span></span>

### <a name="steps"></a><span data-ttu-id="6c3d2-333">Etapas</span><span class="sxs-lookup"><span data-stu-id="6c3d2-333">Steps</span></span>

* <span data-ttu-id="6c3d2-334">Adicionar MixedRealityTeleport a MixedRealityCameraParent</span><span class="sxs-lookup"><span data-stu-id="6c3d2-334">Add MixedRealityTeleport to MixedRealityCameraParent</span></span>
    * <span data-ttu-id="6c3d2-335">Em **hierarquia**, selecione **Usland**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-335">In **Hierarchy**, select **Usland**.</span></span>
    * <span data-ttu-id="6c3d2-336">No **Inspetor**, habilite o **controle de nível**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-336">In **Inspector**, enable **Level Control**.</span></span>
    * <span data-ttu-id="6c3d2-337">Em **hierarquia**, selecione **MixedRealityCameraParent**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-337">In **Hierarchy**, select **MixedRealityCameraParent**.</span></span>
    * <span data-ttu-id="6c3d2-338">No **Inspetor**, clique em **Adicionar componente**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-338">In **Inspector**, click **Add Component**.</span></span>
    * <span data-ttu-id="6c3d2-339">Digite **teleport de realidade misturada** e selecione-o.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-339">Type **Mixed Reality Teleport** and select it.</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="6c3d2-340">Aprofundando-se no código</span><span class="sxs-lookup"><span data-stu-id="6c3d2-340">Digging into the code</span></span>

<span data-ttu-id="6c3d2-341">Os usuários do headset de imersão serão conectados a seus PCs com um cabo, mas nossa ilha é maior do que o cabo é longo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-341">Immersive headset users will be tethered to their PCs with a cable, but our island is larger than the cable is long.</span></span> <span data-ttu-id="6c3d2-342">Para compensar, precisamos da capacidade de mover a câmera independentemente do movimento do usuário.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-342">To compensate, we need the ability to move the camera independently of the user's motion.</span></span> <span data-ttu-id="6c3d2-343">Consulte a [página de conforto](comfort.md) para obter mais informações sobre como criar seu aplicativo de realidade misturada (em particular e Locomotion).</span><span class="sxs-lookup"><span data-stu-id="6c3d2-343">Please see the [comfort page](comfort.md) for more information about designing your mixed reality application (in particular self motion and locomotion).</span></span>

<span data-ttu-id="6c3d2-344">Para descrever esse processo, será útil definir dois termos.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-344">In order to describe this process it will be useful to define two terms.</span></span> <span data-ttu-id="6c3d2-345">Primeiro, **Dolly** será o objeto que move a câmera independentemente do usuário.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-345">First, **dolly** will be the object that moves the camera independently from the user.</span></span> <span data-ttu-id="6c3d2-346">Um objeto de jogo filho do **Dolly** será a **câmera principal**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-346">A child game object of the **dolly** will be the **main camera**.</span></span> <span data-ttu-id="6c3d2-347">A câmera principal é anexada à cabeça do usuário.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-347">The main camera is attached to the user's head.</span></span>

<span data-ttu-id="6c3d2-348">No painel projeto, navegue até **Assets\AppPrefabs\Support\Scripts\GameLogic** e clique duas vezes em **MixedRealityTeleport.cs**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-348">In the project panel, navigate to **Assets\AppPrefabs\Support\Scripts\GameLogic** and double-click on **MixedRealityTeleport.cs**.</span></span>

<span data-ttu-id="6c3d2-349">MixedRealityTeleport tem dois trabalhos.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-349">MixedRealityTeleport has two jobs.</span></span> <span data-ttu-id="6c3d2-350">Primeiro, ele lida com a rotação usando os amortecedores.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-350">First, it handles rotation using the bumpers.</span></span> <span data-ttu-id="6c3d2-351">Na função Update, pesquisamos por ' ButtonUp ' em LeftBumper e RightBumper.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-351">In the update function we poll for 'ButtonUp' on LeftBumper and RightBumper.</span></span> <span data-ttu-id="6c3d2-352">GetButtonUp retorna true no primeiro quadro em que um botão está ativo depois de ter sido desativado.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-352">GetButtonUp only returns true on the first frame a button is up after having been down.</span></span> <span data-ttu-id="6c3d2-353">Se um dos botões tivesse sido gerado, sabemos que o usuário precisa girar.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-353">If either button had been raised, then we know the user needs to rotate.</span></span>

<span data-ttu-id="6c3d2-354">Quando giramos, fazemos um fade out e esmaecemos usando um script simples chamado ' Fade Control '.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-354">When we rotate we do a fade out and fade in using a simple script called 'fade control'.</span></span> <span data-ttu-id="6c3d2-355">Fazemos isso para impedir que o usuário veja um movimento não natural que poderia levar a discomfort.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-355">We do this to prevent the user from seeing an unnatural movement which could lead to discomfort.</span></span> <span data-ttu-id="6c3d2-356">O efeito de fade in e saída é bastante simples.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-356">The fade in and out effect is fairly simple.</span></span> <span data-ttu-id="6c3d2-357">Temos um buraco de cruz preto na frente da **câmera principal**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-357">We have a black quad hanging in front of the **main camera**.</span></span> <span data-ttu-id="6c3d2-358">Ao desbotar, fazemos a transição do valor alfa de 0 para 1.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-358">When fading out we transition the alpha value from 0 to 1.</span></span> <span data-ttu-id="6c3d2-359">Isso gradualmente faz com que os pixels pretos do Quad sejam renderizados e obscurecem qualquer coisa por trás deles.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-359">This gradually causes the black pixels of the quad to render and obscure anything behind them.</span></span> <span data-ttu-id="6c3d2-360">Ao retroceder, fazemos a transição do valor alfa de volta para zero.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-360">When fading back in we transition the alpha value back to zero.</span></span>

<span data-ttu-id="6c3d2-361">Quando calculamos a rotação, observe que estamos girando nosso **Dolly** , mas calculando a rotação em toda a **câmera principal**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-361">When we calculate the rotation, note that we are rotating our **dolly** but calculating the rotation around the **main camera**.</span></span> <span data-ttu-id="6c3d2-362">Isso é importante, pois o mais distante da **câmera principal** está longe de 0, 0, a rotação menos precisa em relação ao Dolly se tornaria do ponto de vista do usuário.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-362">This is important as the farther the **main camera** is away from 0,0,0, the less accurate a rotation around the dolly would become from the point of view of the user.</span></span> <span data-ttu-id="6c3d2-363">Na verdade, se você não girar a posição da câmera, o usuário será movido em um arco em volta do **Dolly** em vez de girar.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-363">In fact, if you do not rotate around the camera position, the user will move on an arc around the **dolly** rather than rotating.</span></span>

<span data-ttu-id="6c3d2-364">O segundo trabalho para MixedRealityTeleport é manipular a movimentação de **Dolly**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-364">The second job for MixedRealityTeleport is to handle moving the **dolly**.</span></span> <span data-ttu-id="6c3d2-365">Isso é feito em SetWorldPosition.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-365">This is done in SetWorldPosition.</span></span> <span data-ttu-id="6c3d2-366">SetWorldPosition usa a posição do mundo desejada, a posição onde o usuário deseja percieve que estar.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-366">SetWorldPosition takes the desired world position, the position where the user wants to percieve that they inhabit.</span></span> <span data-ttu-id="6c3d2-367">Precisamos colocar nosso **Dolly** nessa posição menos a posição local da **câmera principal**, pois esse deslocamento será adicionado a cada quadro.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-367">We need to put our **dolly** at that position minus the local position of the **main camera**, as that offset will be added each frame.</span></span>

<span data-ttu-id="6c3d2-368">Um segundo script chama SetWorldPosition.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-368">A second script calls SetWorldPosition.</span></span> <span data-ttu-id="6c3d2-369">Vamos examinar esse script.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-369">Let's look at that script.</span></span> <span data-ttu-id="6c3d2-370">No painel projeto, navegue até **Assets\AppPrefabs\Support\Scripts\GameLogic** e clique duas vezes em **TeleportScript.cs**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-370">In the project panel, navigate to **Assets\AppPrefabs\Support\Scripts\GameLogic** and double-click on **TeleportScript.cs**.</span></span>

<span data-ttu-id="6c3d2-371">Esse script é um pouco mais envolvido do que MixedRealityTeleport.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-371">This script is a little more involved than MixedRealityTeleport.</span></span> <span data-ttu-id="6c3d2-372">O script está verificando se o botão Y no controlador Xbox será mantido.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-372">The script is checking for the Y Button on the Xbox controller to be held down.</span></span> <span data-ttu-id="6c3d2-373">Enquanto o botão é mantido para baixo, um cursor teleport é renderizado e o script converte um Ray a partir da posição de olhar do usuário.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-373">While the button is held down a teleport cursor is rendered and the script casts a ray from the user's gaze position.</span></span> <span data-ttu-id="6c3d2-374">Se esse raio colidir com uma superfície que está mais ou menos apontando para cima, a superfície será considerada uma boa superfície para teleport e a animação no cursor teleport será habilitada.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-374">If that ray collides with a surface that is more or less pointing up, the surface will be considered a good surface to teleport to, and the animation on the teleport cursor will be enabled.</span></span> <span data-ttu-id="6c3d2-375">Se o raio não colidir com uma superfície mais ou menos apontando para cima, a animação no cursor será desabilitada.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-375">If the ray does not collide with a surface more or less pointing up, then the animation on the cursor will be disabled.</span></span> <span data-ttu-id="6c3d2-376">Quando o botão Y é liberado e o ponto calculado do raio é uma posição válida, o script chama SetWorldPosition com a posição do raio interseccionado.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-376">When the Y button is released and the calculated point of the ray is a valid position, the script calls SetWorldPosition with the position the ray intersected.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="6c3d2-377">Aproveite seu progresso</span><span class="sxs-lookup"><span data-stu-id="6c3d2-377">Enjoy your progress</span></span>

<span data-ttu-id="6c3d2-378">Desta vez, você precisará encontrar um amigo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-378">This time you'll need to find a friend.</span></span>

<span data-ttu-id="6c3d2-379">Mais uma vez, um usuário com o HoloLens hospedará uma sessão.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-379">Once again, a user with the HoloLens will host a session.</span></span> <span data-ttu-id="6c3d2-380">Outros usuários ingressarão na sessão.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-380">Other users will join the session.</span></span> <span data-ttu-id="6c3d2-381">O aplicativo fará com que os três primeiros usuários ingressem de um headset de imersão em um dos três caminhos na ilha.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-381">The application will place the first three users to join from an immersive headset on one of the three paths on the island.</span></span> <span data-ttu-id="6c3d2-382">Sinta-se à vontade para explorar a ilha nesta seção.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-382">Feel free to explore the island in this section.</span></span>

<span data-ttu-id="6c3d2-383">Detalhes a serem observados:</span><span class="sxs-lookup"><span data-stu-id="6c3d2-383">Details to notice:</span></span>

1. <span data-ttu-id="6c3d2-384">Você pode ver os rostos nas nuvens, o que ajuda um usuário imersos a ver qual direção um usuário do HoloLens está olhando.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-384">You can see faces in the clouds, which helps an immersed user see which direction a HoloLens user is looking.</span></span>
2. <span data-ttu-id="6c3d2-385">Os avatars na ilha têm pescoços que giram.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-385">The avatars on the island have necks that rotate.</span></span> <span data-ttu-id="6c3d2-386">Eles não seguirão o que o usuário está fazendo é realidade real (não temos essas informações), mas isso faz uma boa experiência.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-386">They won't follow what the user is doing is real reality (we don't have that information) but it makes for a nice experience.</span></span>
3. <span data-ttu-id="6c3d2-387">Se o usuário do HoloLens estiver olhando para a ilha, os usuários do imersos poderão ver o cursor.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-387">If the HoloLens user is looking at the Island, the immersed users can see their cursor.</span></span>
4. <span data-ttu-id="6c3d2-388">As nuvens que representam os usuários do HoloLens convertem sombras.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-388">The clouds that represent the HoloLens users cast shadows.</span></span>

## <a name="chapter-5---finale"></a><span data-ttu-id="6c3d2-389">Capítulo 5 – final</span><span class="sxs-lookup"><span data-stu-id="6c3d2-389">Chapter 5 - Finale</span></span>

>[!VIDEO https://www.youtube.com/embed/n_HDWJbfpNg]

### <a name="objectives"></a><span data-ttu-id="6c3d2-390">Objetivos</span><span class="sxs-lookup"><span data-stu-id="6c3d2-390">Objectives</span></span>

<span data-ttu-id="6c3d2-391">Crie uma experiência interativa colaborativa entre os dois tipos de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-391">Create a collaborative interactive experience between the two device types.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="6c3d2-392">O que iremos criar</span><span class="sxs-lookup"><span data-stu-id="6c3d2-392">What we will build</span></span>

<span data-ttu-id="6c3d2-393">Com base no capítulo 4, quando um usuário com um headset de imersão fica perto de um quebra-cabeça na ilha, os usuários do HoloLens terão uma dica de ferramenta com uma pista para o quebra-cabeça.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-393">Building on chapter 4, when a user with an immersive headset gets near a puzzle on the island, the HoloLens users will get a tool tip with a clue to the puzzle.</span></span> <span data-ttu-id="6c3d2-394">Depois que todos os usuários do headset de imersão passarem do quebra-cabeças e para a "área pronta" na sala de Rocket, o Rocket será iniciado.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-394">Once all of the immersive headset users get past their puzzles and onto the "ready pad" in the rocket room, the rocket will launch.</span></span>

### <a name="steps"></a><span data-ttu-id="6c3d2-395">Etapas</span><span class="sxs-lookup"><span data-stu-id="6c3d2-395">Steps</span></span>

* <span data-ttu-id="6c3d2-396">Em **hierarquia**, selecione **Usland**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-396">In **Hierarchy**, select **Usland**.</span></span>
* <span data-ttu-id="6c3d2-397">No **Inspetor**, em **controle de nível**, marque **habilitar colaboração**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-397">In **Inspector**, in **Level Control**, check **Enable Collaboration**.</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="6c3d2-398">Aprofundando-se no código</span><span class="sxs-lookup"><span data-stu-id="6c3d2-398">Digging into the code</span></span>

<span data-ttu-id="6c3d2-399">Agora vamos examinar LevelControl.cs.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-399">Now let us look at LevelControl.cs.</span></span> <span data-ttu-id="6c3d2-400">Esse script é o núcleo da lógica do jogo e mantém o estado do jogo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-400">This script is the core of the game logic and maintains the game state.</span></span> <span data-ttu-id="6c3d2-401">Como este é um jogo com vários participantes usando o UNET, precisamos entender como os fluxos de dados, pelo menos, o suficiente para modificar este tutorial.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-401">Since this is a multiplayer game using UNET we need to understand how data flows, at least well enough to modify this tutorial.</span></span> <span data-ttu-id="6c3d2-402">Para obter uma visão geral mais completa do UNET, consulte a documentação do Unity.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-402">For a more complete overview of UNET, please refer to Unity's documentation.</span></span>

<span data-ttu-id="6c3d2-403">No painel projeto, navegue até **Assets\AppPrefabs\Support\Scripts\GameLogic** e clique duas vezes em **LevelControl.cs**.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-403">In the project panel, navigate to **Assets\AppPrefabs\Support\Scripts\GameLogic** and double-click on **LevelControl.cs**.</span></span>

<span data-ttu-id="6c3d2-404">Vamos entender como um headset de imersão indica que eles estão prontos para o lançamento do Rocket.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-404">Let us understand how an immersive headset indicates that they are ready for the rocket launch.</span></span> <span data-ttu-id="6c3d2-405">O Rocket Launch Readiness é comunicado pela definição de um dos Três BOOLs em uma lista de BOOLs que correspondem aos três caminhos na ilha.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-405">Rocket Launch readiness is communicated by setting one of three bools in a list of bools that correspond to the three paths on the island.</span></span> <span data-ttu-id="6c3d2-406">O bool de um caminho será definido quando o usuário atribuído ao caminho estiver na parte superior do painel marrom dentro da sala de Rocket.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-406">A path's bool will be set when the user assigned to the path is on top of the brown pad inside the rocket room.</span></span> <span data-ttu-id="6c3d2-407">Bem, agora para os detalhes.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-407">Okay, now to the details.</span></span>

<span data-ttu-id="6c3d2-408">Começaremos a usar a função Update ().</span><span class="sxs-lookup"><span data-stu-id="6c3d2-408">We will start in the Update() function.</span></span> <span data-ttu-id="6c3d2-409">Você observará que há uma função ' enganar '.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-409">You will note that there is a 'cheat' function.</span></span> <span data-ttu-id="6c3d2-410">Nós usamos isso em desenvolvimento para testar a sequência de inicialização e redefinição do Rocket.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-410">We used this in development to test the rocket launch and reset sequence.</span></span> <span data-ttu-id="6c3d2-411">Ele não funcionará na experiência de vários usuários.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-411">It won't work in the multi user experience.</span></span> <span data-ttu-id="6c3d2-412">Espero que, no momento em que você internalizar o seguinte inprocedimento, você possa fazê-lo funcionar.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-412">Hopefully by the time you internalize the following infromation you can make it work.</span></span> <span data-ttu-id="6c3d2-413">Depois de verificarmos para ver se devemos enganar, verificamos se o player local é imersos.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-413">After we check to see if we should cheat, we check to see if the local player is immersed.</span></span> <span data-ttu-id="6c3d2-414">Queremos nos concentrar em como descobrimos que estamos no objetivo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-414">We want to focus on how we find that we're at the goal.</span></span> <span data-ttu-id="6c3d2-415">Dentro da verificação if (imersos), há uma chamada para CheckGoal ocultando por trás do **EnableCollaboration** bool.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-415">Inside of the if (Immersed) check, there is a call to CheckGoal hiding behind the **EnableCollaboration** bool.</span></span> <span data-ttu-id="6c3d2-416">Isso corresponde à caixa de seleção selecionada ao concluir as etapas deste capítulo.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-416">This corresponds to the checkbox you checked while completing the steps for this chapter.</span></span> <span data-ttu-id="6c3d2-417">Dentro de EnableCollaboration, vemos uma chamada para CheckGoal ().</span><span class="sxs-lookup"><span data-stu-id="6c3d2-417">Inside of EnableCollaboration we see a call to CheckGoal().</span></span>

<span data-ttu-id="6c3d2-418">CheckGoal faz algumas matemáticas para ver se estamos mais ou menos em pé no painel.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-418">CheckGoal does some math to see if we are more or less standing on the pad.</span></span> <span data-ttu-id="6c3d2-419">Quando estamos, Depuramos. log "chegou ao objetivo" e, em seguida, chamamos ' SendAtGoalMessage () '.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-419">When we are, we Debug.Log "Arrived at goal" and then we call 'SendAtGoalMessage()'.</span></span> <span data-ttu-id="6c3d2-420">Em SendAtGoalMessage, chamamos playerController. SendAtGoal.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-420">In SendAtGoalMessage we call playerController.SendAtGoal.</span></span> <span data-ttu-id="6c3d2-421">Para economizar algum tempo, aqui está o código:</span><span class="sxs-lookup"><span data-stu-id="6c3d2-421">To save you some time, here's the code:</span></span>

```cs
private void CmdSendAtGoal(int GoalIndex)
{
    levelState.SetGoalIndex(GoalIndex);
}
```

```cs
public void SendAtGoal(int GoalIndex)
{
    if (isLocalPlayer)
    {
        Debug.Log("sending at goal " + GoalIndex);
        CmdSendAtGoal(GoalIndex);
    }
}
```

<span data-ttu-id="6c3d2-422">Observe que SendAtGoalMessage chama CmdSendAtGoal, que chama levelstate. SetGoalIndex, que está de volta em LevelControl.cs.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-422">Note that SendAtGoalMessage calls CmdSendAtGoal, which calls levelState.SetGoalIndex, which is back in LevelControl.cs.</span></span> <span data-ttu-id="6c3d2-423">À primeira vista, isso parece estranho.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-423">At first glance this seems strange.</span></span> <span data-ttu-id="6c3d2-424">Por que não apenas chamar SetGoalIndex em vez desse roteamento estranho por meio do controlador do jogador?</span><span class="sxs-lookup"><span data-stu-id="6c3d2-424">Why not just call SetGoalIndex rather than this strange routing through the player controller?</span></span> <span data-ttu-id="6c3d2-425">O motivo é que estamos em conformidade com o modelo de dados que o UNET usa para manter os dados sincronizados. Para evitar trapaceando e ultrapaginação, o UNET requer que cada objeto tenha um usuário que tenha autoridade para alterar as variáveis sincronizadas.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-425">The reason is that we are conforming to the data model UNET uses to keep data in sync. To prevent cheating and thrashing, UNET requires that each object has a user who has authority to change the synchronized variables.</span></span> <span data-ttu-id="6c3d2-426">Além disso, somente o host (o usuário que iniciou a sessão) pode alterar os dados diretamente.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-426">Further, only the host (the user that started the session) can change data directly.</span></span> <span data-ttu-id="6c3d2-427">Os usuários que não são o host, mas têm autoridade, precisam enviar um ' Command ' para o host que alterará a variável.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-427">Users who are not the host, but have authority, need to send a 'command' to the host which will change the variable.</span></span> <span data-ttu-id="6c3d2-428">Por padrão, o host tem autoridade sobre todos os objetos, exceto pelo objeto gerado para representar o usuário.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-428">By default the host has authority over all objects, except for the object spawned to represent the user.</span></span> <span data-ttu-id="6c3d2-429">Em nosso caso, esse objeto tem o script playercontroller.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-429">In our case this object has the playercontroller script.</span></span> <span data-ttu-id="6c3d2-430">Há uma maneira de solicitar autoridade para um objeto e, em seguida, fazer alterações, mas optamos por aproveitar o fato de que o controlador do Player tem comandos Self Authority e Route por meio do controlador do jogador.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-430">There is a way to request authority for an object and then make changes, but we choose to leverage the fact that the player controller has self authority and route commands through the player controller.</span></span>

<span data-ttu-id="6c3d2-431">Dito outra maneira, quando nos encontramos em nossa meta, o jogador precisa dizer ao host, e o host informará a todos os outros.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-431">Said another way, when we've found ourselves at our goal, the player needs to tell the host, and the host will tell everyone else.</span></span>

<span data-ttu-id="6c3d2-432">De volta ao LevelControl.cs, consulte SetGoalIndex.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-432">Back in LevelControl.cs look at SetGoalIndex.</span></span> <span data-ttu-id="6c3d2-433">Aqui, estamos definindo o valor de um valor em uma synclist (AtGoal).</span><span class="sxs-lookup"><span data-stu-id="6c3d2-433">Here we are setting the value of a value in a synclist (AtGoal).</span></span> <span data-ttu-id="6c3d2-434">Lembre-se de que estamos no contexto do host enquanto fazemos isso.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-434">Remember that we are in the context of the host while we do this.</span></span> <span data-ttu-id="6c3d2-435">Semelhante a um comando, um RPC é algo que o host pode emitir e fará com que todos os clientes executem algum código.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-435">Similar to a command, an RPC is something the host can issue that will cause all clients to run some code.</span></span> <span data-ttu-id="6c3d2-436">Aqui, chamamos ' RpcCheckAllGoals '.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-436">Here we call 'RpcCheckAllGoals'.</span></span> <span data-ttu-id="6c3d2-437">Cada cliente verifica individualmente se todos os três AtGoals estão definidos e, nesse caso, inicia o Rocket.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-437">Each client will individually check to see if all three AtGoals are set, and if so, launch the rocket.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="6c3d2-438">Aproveite seu progresso</span><span class="sxs-lookup"><span data-stu-id="6c3d2-438">Enjoy your progress</span></span>

<span data-ttu-id="6c3d2-439">Criando no capítulo anterior, iniciaremos a sessão como antes.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-439">Building on the previous chapter, we will start the session as before.</span></span> <span data-ttu-id="6c3d2-440">Desta vez, à medida que os usuários no headset de imersão chegarem à "porta" em seu caminho, uma dica de ferramenta aparecerá para que apenas os usuários do HoloLens possam ver.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-440">This time as the users in the immersive headset get to the "door" on their path, a tooltip will appear that only the HoloLens users can see.</span></span> <span data-ttu-id="6c3d2-441">Os usuários do HoloLens são responsáveis por comunicar essa pista aos usuários no headset de imersão.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-441">The HoloLens users are responsible for communicating this clue to the users in the immersive headset.</span></span> <span data-ttu-id="6c3d2-442">O Rocket será iniciado em espaço depois que cada avatar tiver passado em seu painel marrom correspondente dentro do vulcão.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-442">The rocket will launch to space once each avatar has stepped on its corresponding brown pad inside the volcano.</span></span> <span data-ttu-id="6c3d2-443">A cena será redefinida após 60 segundos para que você possa fazer isso novamente.</span><span class="sxs-lookup"><span data-stu-id="6c3d2-443">The scene will reset after 60 seconds so you can do it again.</span></span>

## <a name="see-also"></a><span data-ttu-id="6c3d2-444">Consulte também</span><span class="sxs-lookup"><span data-stu-id="6c3d2-444">See also</span></span>

* [<span data-ttu-id="6c3d2-445">Entrada MR 213: controladores de movimento</span><span class="sxs-lookup"><span data-stu-id="6c3d2-445">MR Input 213: Motion controllers</span></span>](mixed-reality-213.md)
